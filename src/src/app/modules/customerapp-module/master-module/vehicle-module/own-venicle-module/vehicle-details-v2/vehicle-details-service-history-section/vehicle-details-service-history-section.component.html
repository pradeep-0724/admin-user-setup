<div class="container-fluid">
    <div class="row align-items-lg-stretch ">
        <div class="col-lg-7 px-lg-2 p-0 rounded-3 layout-bg h-100 card-shadow">
            <div class="row ">
                <app-table-widget tableTitle="Service Status" [isDateRange]="true"
                    (dateRangeEmitter)="dateRangeJobCard($event)" [selectedDateRangeType]="-1"></app-table-widget>
            </div>
            <div class="row px-2 pb-3 def-color">
                <div class="col-12   ">
                    <div class="stats-card rounded-3 blue-card ">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Total Job Card</span>
                            <span class="stats-icon">
                                <i class="bi bi-gear-fill"></i>
                            </span>
                        </div>
                        <p class="fs-5 fw-bold mt-3">{{jobCardCountsCost?.jobcard_count}}</p>
                    </div>
                </div>
                <div class="col-12  mt-3 ">
                    <div class="stats-card green-cost-card  green-card rounded-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Total Job Card Cost</span>
                            <span class="stats-icon">

                            </span>
                        </div>
                        <p class="fs-5 fw-bold mt-3">{{ currency_type?.symbol}} {{fixedTo3Decimal(jobCardCountsCost?.jobcard_cost)| numberFormat}}</p>
                    </div>
                </div>

            </div>



        </div>



        <div class="col-lg-5 ps-lg-3 p-0  mt-4 mt-lg-0  ">
            <div class="layout-bg  row mx-1 def-color p-0 rounded-3 card-shadow">
                <app-table-widget tableTitle="Service Expense" [isDateRange]="true" class="border-bottom border-2"
                    (dateRangeEmitter)="dateRangeDougnut($event)" [selectedDateRangeType]='-1'></app-table-widget>
                <div class="col-12">
                    <div class="chart">
                        <div class="no-list-data-wrap"  style="min-height: 213px;" *ngIf="serviceExpense.length==0">
                            <figure>
                                <img src="assets/img/no-content.png" alt="">
                            </figure>
                            <h5 class="mt-3 primary-brand-text">No data found!</h5>
                        </div>
                        <div class="row" *ngIf="serviceExpense.length">
                            <div class="col-md-6">
                                <div  class="labes-div">
                                    <div *ngFor="let label of chartLabels;let i = index" class="d-flex justify-content-between align-items-center py-2" >
                                       <p class="label-dot" [ngStyle]="{'background-color':lagendColors[i]}">&nbsp;</p>
                                        <p>{{label}}</p>
                                     
                                    </div>

                                </div>

                            </div>
                            <div class="col-md-6">
                                <div class="canvas-hight"   >
                                    <div class="chart-inside">
                                        <p class="fw-bold">{{ currency_type?.symbol}} {{fixedTo3Decimal(totalServices)| numberFormat}}</p>
                                        <p class="mt-1">Total Expense</p>
                                    </div>
                                    <canvas baseChart *ngIf="serviceExpense.length" [labels]="chartLabels"
                                        [datasets]="chartData" [options]="chartOptions" [chartType]="'doughnut'">
                                    </canvas>
                                </div>
                            </div>
                        </div>
                      

                    </div>
                </div>

            </div>
        </div>
    </div>

   
    <div class="row rounded-3 mt-4 pb-3  layout-bg def-color card-shadow">
        <app-table-widget tableTitle="Job Card Summary" [isDateRange]="true" [isShowDateRangeText]="true"
            [isSearch]="true" (searchedData)="searchedDataJobCardSummary($event)"
            (dateRangeEmitter)="dateRangeJobCardSummary($event)"[selectedDateRangeType]='-1'>
            <button id="custom-export" (click)="fileExportEventForJobCard()" class="save-file ms-2">
                <span class="material-icons">save_alt</span></button>
        </app-table-widget>
        <div class="col-12 p-0" >
            <div class="custom-table-container  job_card_summary" (scroll)="onScroll($event)">
                <table>

                    <thead>
                        <tr>
                            <th>
                                SERVICE DATE
                            </th>
                            <th>
                                JOB CARD NO.
                            </th>
                            <th>
                                SPARE COST ({{ currency_type?.symbol}})
                            </th>
                            <th>
                                LABOUR COST ({{ currency_type?.symbol}})
                            </th>
                            <th *ngIf="isTax">
                                TAX  ({{ currency_type?.symbol}})
                            </th>
                            <th>TOTAL ({{ currency_type?.symbol}})</th>
                        </tr>
                    </thead>
                    <tbody *ngIf="jobCardList.length==0">
                        <tr class="border-0">
                            <td class="bg-white" colspan="30">
                                <div class="no-list-data-wrap">
                                    <figure>
                                        <img src="assets/img/no-content.png" alt="">
                                    </figure>
                                    <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                </div>
                            </td>
                        </tr>

                    </tbody>

                    <tbody>
                        <tr *ngFor="let jobcard of jobCardList ">
                            <td>
                                {{jobcard?.start_date}}
                            </td>
                            <td>
                                <a target="_blank"  class="custom-link" 
                                    [routerLink]="[getPrefixUrl+'/expense/maintenance/view/'+jobcard.id+'/']"
                                    > {{jobcard?.job_card_no}} </a>
                            </td>
                            <td>
                                {{jobcard?.spare_total | numberFormat}}

                            </td>
                            <td>
                                {{jobcard?.labour_total | numberFormat}}

                            </td>
                            <td *ngIf="isTax">
                                {{jobcard?.tax_total | numberFormat}}

                            </td>
                            <td>
                                {{jobcard?.total_amount | numberFormat}}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>



        </div>
    </div>

    <div class="row rounded-3 mt-4 pb-3 layout-bg def-color card-shadow">
        <app-table-widget tableTitle="Services" [isDateRange]="true" [isShowDateRangeText]="true" [isSearch]="true"
            (searchedData)="searchedDataVehicleService($event)"
            (dateRangeEmitter)="dateRangeVehicleService($event)" [selectedDateRangeType]='-1'>
            <button id="custom-export" (click)="fileExportEventForServices()" class="save-file ms-2">
                <span class="material-icons">save_alt</span></button>
        </app-table-widget>
        <div class="col-12 p-0" >
            <div class="custom-table-container vehicle_service" (scroll)="onScrollVehicleService($event)">
                <table>

                    <thead>
                        <tr>
                            <th>
                                SERVICE NAME
                            </th>
                            <th>
                                TOTAL COUNT
                            </th>
                            <th>
                                SPARE COST ({{ currency_type?.symbol}})
                            </th>
                            <th>
                                LABOUR COST ({{ currency_type?.symbol}})
                            </th>
                            <th *ngIf="isTax">
                                TAX  ({{ currency_type?.symbol}})
                            </th>
                            <th>TOTAL COST ({{ currency_type?.symbol}})</th>
                            <th>HISTORY</th>
                        </tr>
                    </thead>
                    <!-- no-data component -->
                    <tbody *ngIf="vehicleServiceList.length==0">
                        <tr class="border-0">
                            <td class="bg-white" colspan="30">
                                <div class="no-list-data-wrap">
                                    <figure>
                                        <img src="assets/img/no-content.png" alt="">
                                    </figure>
                                    <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                </div>
                            </td>
                        </tr>

                    </tbody>

                    <tbody>
                        <tr *ngFor="let service of vehicleServiceList">
                            <td>
                                {{service?.service_name}}
                            </td>
                            <td>
                                {{service?.service_count | numberFormat}}
                            </td>
                            <td>
                                {{service?.spare_cost | numberFormat}}
                            </td>
                            <td>
                                {{service?.labour_cost | numberFormat}}
                            </td>
                            <td *ngIf="isTax">
                                {{service?.total_tax | numberFormat}}
                            </td>
                            <td>
                                {{service?.total_cost | numberFormat}}
                            </td>
                            <td>
                                <mat-icon class="sky-blue-text" (click)="openHistory(service)">history</mat-icon>
                            </td>

                        </tr>
                    </tbody>
                </table>
            </div>


        </div>
    </div>
</div>
<app-service-history-list *ngIf="isOpenHistoryData.open" [vehicleId]="vehicleId" [isOpenHistoryData]="isOpenHistoryData"></app-service-history-list>