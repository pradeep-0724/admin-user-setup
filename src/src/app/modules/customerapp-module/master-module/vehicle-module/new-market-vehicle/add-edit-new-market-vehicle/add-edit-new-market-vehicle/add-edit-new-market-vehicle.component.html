<div class="add-screen-wrap d-flex flex-column">
    <div class="def-color px-4 py-3 layout-bg">

        <h6 class="fs-5"  *ngIf="!vehicleId">Add Market Vehicle</h6>
        <h6 class="fs-5" *ngIf="vehicleId">Edit Market Vehicle</h6>
    </div>   

     <div class="def-color p-4 shadow-inset-top-bottom">
        <p class=" fw-semibold">Vehicle Category<span class="text-danger">*</span></p>
        <p class="error-reg mt-1">{{category_selected_err}}</p>
        <div class="d-flex flex-wrap gap-4 align-items-center pt-4" [class.disable]="is_vehicle_selection_disabled">

            <div class="   veh-type"Â matRipple (click)="vehicleTypeSelected(1)" [class.active]="vehicle_type_selected ==1">
                <img src="../../../../../../../../assets/img/icons/crane-truck.svg"  alt="truck image">

                               <p class="text-center mt-2">Crane</p>
            </div>

            <div class="   veh-type" matRipple (click)="vehicleTypeSelected(2)" [class.active]="vehicle_type_selected ==2">
                <img src="../../../../../../../../assets/img/icons/awp.svg "   alt="truck image">
               <p class="text-center mt-2">AWP</p>
            </div>
            <div class="   veh-type" matRipple (click)="vehicleTypeSelected(3)" [class.active]="vehicle_type_selected ==3">
                <img src="../../../../../../../../assets/img/icons/trailer-head.svg"   alt="tra image">
               <p class="text-center mt-2">Trailer Head</p>
            </div>
            <div class="   veh-type" matRipple (click)="vehicleTypeSelected(0)" [class.active]="vehicle_type_selected ==0">
                <img src="../../../../../../../../assets/img/icons/truck-vehicle.svg"   alt="truck image">
               <p class="text-center mt-2">Others</p>
            </div>

        </div>


    </div> 

    <div class=" flex-grow-1 d-flex justify-content-center align-items-center flex-column" *ngIf="!is_vehicle_type_selected">

        <i class="bi bi-truck select-veh-truck"></i>
        <p class="select-veh-text">Please select your  vehicle category for more details</p>
    </div>
    <div class="" *ngIf="is_vehicle_type_selected">
        <form [formGroup]="marketVehicleForm">
            <div class="alert-msg" *ngIf="apiError">
                <span class="icon-wrap"></span>
                <p class="message-cont">{{ apiError }}</p>
            </div>
            <div class="row mx-0 p-4 pb-0 px-3">
                <div class="col-xl-3 col-lg-4 col-sm-6 ">
                    <div class="input-wrap error" [ngClass]="addErrorClass(marketVehicleForm.controls.reg_number)">
                        <label for="" class="input--required">Vehicle No.</label>
                        <input appUpperCase type="text" class="no-style input--bd" placeholder="AAAA0000"
                            formControlName="reg_number" maxlength="14" value="">
                        <span *ngIf="regError" class="error-reg">{{regError}}</span>
                        <app-error [controlName]="marketVehicleForm.controls.reg_number"></app-error>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-4 col-sm-6">
                    <div class="input-wrap">
                        <label for="" class="">Specification</label>
                        <material-dropdown [searchable]="true" [selectedOption]="initialValues.vehicle_type"
                            [addable]="true" class="dropDownWidth" [addBlank]="true" [postApiUrl]="vehicleApi"
                            [params]="addVehicle" (postApiResponse)="getNewVehicle($event)"
                            (addValueToList)="addNewVehicle($event)">
                            <select #customSelect formControlName="vehicle_type" class="no-style select--modify" (change)="vehicleSpecificationChange()">
                                <option *ngFor="let option of vechileTypeList" value="{{ option?.id }}">
                                    {{ option?.specification }}
                                </option>
                            </select>
                        </material-dropdown>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-4 col-sm-6">
                    <div class="input-wrap m-0">
                        <label for="" class="input">Vehicle(Brand and Model)</label>
                    </div>
                    <ng-container formGroupName="brand">
                        <div class="row">
                            <div class="col-6">
                                <div class="input-wrap"
                                    [ngClass]="addErrorClass(marketVehicleForm.controls.brand.get('make'))">
                                    <material-dropdown [searchable]="true" [addBlank]="true" [selectedOption]="initialValues.make"
                                        [addable]="true" [disabled]="!marketVehicleForm.controls.vehicle_type.value"  class="dropDownWidth"
                                        [postApiUrl]="vehicleMakeUrl" [params]="vehicleMakeParam"
                                        (postApiResponse)="getNewVehicleMake($event)"
                                        (addValueToList)="addNewVehicleMake($event)">
                                        <select #customSelect formControlName="make" class="no-style select--modify"
                                            (change)="onMakeSelected($event)">
                                            <option *ngFor="let option of vehicleMake" value="{{ option.id }}">
                                                {{ option.make_name }}
                                            </option>
                                        </select>
                                    </material-dropdown>
                                    <app-error [controlName]="marketVehicleForm.controls.brand.get('make')"></app-error>
                                </div>
                            </div>
                            <div class="col-6" [ngClass]="{'disable':!marketVehicleForm.controls.brand.get('make').value}">
                                <div class="input-wrap"
                                    [ngClass]="addErrorClass(marketVehicleForm.controls.brand.get('model'))">
                                    <material-dropdown  [disabled]="!marketVehicleForm.controls.brand.get('make').value" [addBlank]="true" [selectedOption]="initialValues.model" [searchable]="true"
                                        [addable]="true" class="dropDownWidth"
                                        [postApiUrl]="vehicleModelUrl" [params]="vehicleModelParam"
                                        (postApiResponse)="getNewVehicleModel($event)"
                                        (addValueToList)="addNewVehicleModel($event)">
                                        <select #customSelect formControlName="model" class="no-style select--modify">
                                            <option *ngFor="let option of vehicleModel" value="{{ option.id }}">
                                                {{ option.model_name }}
                                            </option>
                                        </select>
                                    </material-dropdown>
                                    <app-error
                                        [controlName]="marketVehicleForm.controls.brand.get('model')"></app-error>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </div>
                <div class="col-xl-3 col-lg-3 col-6">
                    <div class="input-wrap error" [ngClass]="addErrorClass(marketVehicleForm.controls.market_owner)">
                        <label for="">Vehicle Provider</label>
                        <material-dropdown [searchable]="true" [selectedOption]="initialValues.market_owner"
                            [addable]="true" [addBlank]="true" [maxLength]="46" [status]="true" [party]="true"
                            (addPartyPopup)="openAddPartyModal($event, 'vendor')"
                            (addValueToList)="addValueToPartyPopup($event, vehicleprovider)" [params]="partyNamePopup">
                            <select #customSelect formControlName="market_owner" class="no-style select--modify">
                                <option *ngFor="let option of partyListVendor" value="{{ option?.id }}">
                                    {{ option?.party_display_name }}
                                </option>
                            </select>
                        </material-dropdown>
                        <app-error [controlName]="marketVehicleForm.controls.market_owner"></app-error>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-4 col-sm-6">
                    <div class="input-wrap">
                        <label for="">Operator Name</label>
                        <input type="text" class="no-style input--bd" placeholder="Operator name"
                            formControlName="market_driver">
                        <span *ngIf="vechileAlreadyAssignError" class="error-reg">{{vechileAlreadyAssignError}}</span>
                    </div>
                </div>
                <div class="col-xl-3 col-lg-4 col-sm-6">
                    <div class="input-wrap mb-0">
                        <label for="">Operator Number</label>

                        <div class="row ">
                            <div class="col-4 ">
                                <div class="width-country-code custom-margin me-0">

                                    <material-dropdown class="dropDownWidth"
                                        [selectedOption]="initialValues.mobile_country_code">
                                        <select #customSelect formControlName="mobile_country_code"
                                            class="no-style select--modify">
                                            <option *ngFor="let phone_code of countryPhoneCode" [value]="phone_code">
                                                {{phone_code}}
                                            </option>
                                        </select>
                                    </material-dropdown>
                                </div>
                            </div>

                            <div class="px-0 number-grow col-8 px-0">
                                <div class="ms-3">

                                    <div class="w-auto px-0 number-grow">
                                        <div class="error input-wrap"
                                            [ngClass]="addErrorClass(marketVehicleForm.controls.mobile)">

                                            <input type="text" PositiveDigitNumber class="no-style input--bd" placeholder="9999999999"
                                                formControlName="mobile">
                                            <app-error [controlName]="marketVehicleForm.controls.mobile"></app-error>

                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="fake-tab-bar"><span [ngClass]="{taberror:marketVehicleForm.get('documents').invalid && isFormSubmitted}">Certificates</span></div>
            <app-new-market-vehicle-documents [inValid]="isCertificateValid" [marketVehicleForm]="marketVehicleForm" [editData]="editData"
                [isEdit]="isEdit" [vehicle_category]="vehicle_category" [isFormSubmitted]="isFormSubmitted"></app-new-market-vehicle-documents>

               
        </form>
    </div>
   

</div>
<div class="footer-bg p-2 px-4 custom-footer-bg d-flex justify-content-end">
    <button class="btn btn--sm me-2" type="button"
        [routerLink]="[prefixUrl+'/onboarding/vehicle/market/list']">Cancel</button>
    <button class="btn btn--primary btn--sm" (click)="submitForm()">{{vehicleId? 'Update':'Save'}}</button>
</div>
<app-add-party-popup vendorPartyType="2" *ngIf="showAddPartyPopup.status" [popDetail]="showAddPartyPopup"
    [isVendor]="vendor" (closeModal)="closePartyPopup()" (partyAdded)="addPartyToOption($event)"></app-add-party-popup>