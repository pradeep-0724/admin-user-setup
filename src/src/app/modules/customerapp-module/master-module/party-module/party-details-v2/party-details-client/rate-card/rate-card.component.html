<div class=" rounded-3 layout-bg def-color rate-card-wrap overflow-hidden custom-shadow-md">
    <app-table-widget [isFilter]="false" tableTitle="Rate Card List" [isSearch]="false">
        <div id="custom-right-btn" class="ms-2 d-flex align-items-center">
            <button class=" gb-btn gb-btn-blue gb-btn-blue-fill me-2" *ngxPermissionsOnly="[partyPermission[0]]"  (click)="addRateCard('additional')"><span
                class="me-1">+</span>Add Additional Charge</button>
            <button class="gb-btn gb-btn-green gb-btn-green-fill me-1 " *ngxPermissionsOnly="[partyPermission[0]]" (click)="addRateCard('add')"><span class="me-1">+</span>Add
                Rental Charge</button>
                    <button class="gb-btn gb-btn-green gb-btn-green-fill me-1 " [disabled]="doesCompanyRateCardExisted" *ngxPermissionsOnly="[partyPermission[0]]" (click)="addRateCard('customer-rate-card')"><span class="me-1">+</span>
                        Create Container Rate Card</button>
        </div>
    </app-table-widget>
    
    <!-- tabs code will be here  -->
    <div class="custom-fake-tab   border-bottom">
        <button (click)="tabChanged(1)" matRipple class="tab"  [ngClass]="{'active-tab':selectedTab==1}">Rental
            Charge</button>
        <button (click)="tabChanged(2)" matRipple class="tab"  [ngClass]="{'active-tab':selectedTab==2}">Additional
            Charge</button>
            <button (click)="tabChanged(3)" matRipple class="tab"  [ngClass]="{'active-tab':selectedTab==3}">
                Rate Card</button>
    </div>
    <div class=" tab-content ">
        <ng-container *ngIf="selectedTab==1">
            <div class="no-list-data-wrap mt-5" *ngIf="rentalRateCardDetails.length==0">
                <figure><img src="assets/img/no-content.png" alt=""></figure>
                <h5 class="mt-3 primary-brand-text">No Rental Charges Found!</h5>
            </div>

            <div class="   def-color custom-shadow-md rounded-3 "   
                *ngFor="let rateCard of rentalRateCardDetails;let i=index" [ngClass]="i != rentalRateCardDetails.length -1 ? 'mb-3':''">
                <app-table-widget tableTitle="Date: {{ changeDate(rateCard?.date)}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Zone:&nbsp;{{rateCard?.zone?.name ? rateCard?.zone?.name :'-'}}  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Billing Unit:&nbsp; {{getBillingLabel(rateCard?.billing_unit)}}" [isCollapsable]="true"
                    [isExpanded]="i<=0?true:false" (expandCollapseEvent)="expandCollapseInvoiceTable($event,i)"
                    [isSearch]="false" [isExport]="false" (fileExportEvent)="fileExportEvent($event,rateCard.id)">
                    <div id="custom-right-btn">

                        <div class="icon-box  tabIndexActive">
                            <div class="d-flex justify-content-center align-items-center">
                                <div class="position-relative">
                                    <i class="material-icons more-icon  rate-card-more"
                                        (click)="optionsList($event, 'list_'+rateCard.id)">more_vert</i>
                                    <ul class="more-actions__menu table-popup"
                                        [ngClass]="{show: showOptions === 'list_'+rateCard.id}">
                                        <li class="more-actions__item" *ngxPermissionsOnly="[partyPermission[1]]" (click)="editRateCard('edit',rateCard.id)"><i
                                                class="material-icons">edit</i>Edit</li>

                                        <li class="more-actions__item" *ngxPermissionsOnly="[partyPermission[2]]" (click)="deleteRateCard(rateCard.id)"><i
                                                class="material-icons">delete</i>Delete</li>

                                    </ul>
                                </div>
                            </div>

                        </div>
                    </div>
                </app-table-widget>


                <div class=" px-3 pb-3 " [@collapse]="isExpandCollapse[i]">

                    <div class="addable-row-table addable-row-table-display  " id="rental-rate-card-table" (scroll)="onScroll()"> 
                        <table>
                            <thead>
                                <tr>
                                    <th rowspan="2" >
                                        VEHICLE CATEGORY
                                    </th>
                                    <th rowspan="2" >
                                        SPECIFICATION
                                    </th>
                                    <th colspan="3" class="text-center">{{getDurationLabel(rateCard?.billing_unit).daily}}</th>
                                    <th colspan="3" class="text-center">{{getDurationLabel(rateCard?.billing_unit).weekly}}</th>
                                    <th colspan="3" class="text-center">{{getDurationLabel(rateCard?.billing_unit).monthly}}</th>
                                    
                                </tr>
                                <tr>
                                    <th >WITH FUEL</th>
                                    <th >WITHOUT FUEL</th>
                                    <th >EXTRA 
                                        <ng-container *ngIf="rateCard?.billing_unit=='hour'">
                                            HOURS
                                        </ng-container>
                                        <ng-container *ngIf="rateCard?.billing_unit=='day'">
                                            DAYS
                                        </ng-container>
                                        </th>
                                    <th >WITH FUEL</th>
                                    <th >WITHOUT FUEL</th>
                                    <th >EXTRA 
                                        <ng-container *ngIf="rateCard?.billing_unit=='hour'">
                                            HOURS
                                        </ng-container>
                                        <ng-container *ngIf="rateCard?.billing_unit=='day'">
                                            DAYS
                                        </ng-container>
                                    </th>
                                    <th >WITH FUEL</th>
                                    <th >WITHOUT FUEL</th>
                                    <th >EXTRA 
                                        <ng-container *ngIf="rateCard?.billing_unit=='hour'">
                                            HOURS
                                        </ng-container>
                                        <ng-container *ngIf="rateCard?.billing_unit=='day'">
                                            DAYS
                                        </ng-container>
                                    </th>
                                    
                                </tr>
                            </thead>
                            <tbody *ngIf="rateCard?.ratecardmeta?.length==0">
                                <tr class="border-0">
                                    <td colspan="30" class="bg-white">
                                        <div class="no-list-data-wrap">
                                            <figure><img src="assets/img/no-content.png" alt=""></figure>
                                            <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                            <tbody>
                                <tr *ngFor="let rates of rateCard?.ratecardmeta">
                                    <td>{{rates?.vehicle_category ? rates?.vehicle_category :'-'}} </td>
                                    <td>{{rates?.specification?.name ? rates?.specification?.name :'-'}} </td>
                                    <td>{{rates?.daily_rate?.with_fuel | numberFormat}}</td>
                                    <td>{{rates?.daily_rate?.without_fuel| numberFormat}}</td>
                                    <td>{{rates?.daily_rate?.additional_hours| numberFormat}}</td>
                                    <td>{{rates?.weeky_rate?.with_fuel| numberFormat}}</td>
                                    <td>{{rates?.weeky_rate?.without_fuel| numberFormat}}</td>
                                    <td>{{rates?.weeky_rate?.additional_hours| numberFormat}}</td>
                                    <td>{{rates?.monthly_rate?.with_fuel| numberFormat}}</td>
                                    <td>{{rates?.monthly_rate?.without_fuel| numberFormat}}</td>
                                    <td>{{rates?.monthly_rate?.additional_hours| numberFormat}}</td>
                                    
                                </tr>

                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </ng-container>

        <ng-container *ngIf="selectedTab==2">
            <div class="no-list-data-wrap mt-5" *ngIf="AdditionalRateCardDetails?.length==0">
                <figure><img src="assets/img/no-content.png" alt=""></figure>
                <h5 class="mt-3 primary-brand-text">No Additional Charges Found!</h5>
            </div>

            <div class="   def-color custom-shadow-md rounded-3"   
                *ngFor="let rateCard of AdditionalRateCardDetails;let i=index" [ngClass]="i != AdditionalRateCardDetails.length -1 ? 'mb-3':''">
                <app-table-widget tableTitle="Date: {{ changeDate(rateCard?.date)}}" [isCollapsable]="true"
                    [isExpanded]="i<=0?true:false" (expandCollapseEvent)="expandCollapseInvoiceTableCharges($event,i)"
                    [isSearch]="false" [isExport]="false" (fileExportEvent)="fileExportEvent($event,rateCard.id)">
                    <div id="custom-right-btn">

                        <div class="icon-box  tabIndexActive">
                            <div class="d-flex justify-content-center align-items-center">
                                <div class="position-relative">
                                    <i class="material-icons more-icon  rate-card-more"
                                        (click)="optionsList($event, 'list_'+rateCard.id)">more_vert</i>
                                    <ul class="more-actions__menu table-popup"
                                        [ngClass]="{show: showOptions === 'list_'+rateCard.id}">
                                        <li class="more-actions__item" *ngxPermissionsOnly="[partyPermission[1]]" (click)="editRateCard('additional',rateCard.id)"><i
                                                class="material-icons">edit</i>Edit</li>

                                        <li class="more-actions__item" *ngxPermissionsOnly="[partyPermission[2]]" (click)="deleteRateCard(rateCard.id)"><i
                                                class="material-icons">delete</i>Delete</li>

                                    </ul>
                                </div>
                            </div>

                        </div>
                    </div>
                </app-table-widget>


                <div class="px-3 pb-3" [@collapse]="isExpandCollapseForAdditionlCharges[i]">

                    <div class="addable-row-table addable-row-table-display " id="additional-rate-card-table" (scroll)="scrollCharges()">
                        <table>
                            <thead>
                                <tr>                                
                                    <th  class="py-3 w-50">ADDITIONAL CHARGES</th>
                                    <th  class="py-3 w-50" *ngIf="isTax">TAX</th>
                                    <th  class="py-3 w-50">UNIT OF MEASUREMENT</th>
                                    <th  class="py-3 w-50">UNIT COST ({{currency_type?.symbol}})</th>
                                    <th class="py-3 w-50">VEHICLE CATEGORY </th>
                                </tr>
                                
                            </thead>
                            <tbody *ngIf="rateCard?.ratecardmeta?.length==0">
                                <tr class="border-0">
                                    <td colspan="30" class="bg-white">
                                        <div class="no-list-data-wrap">
                                            <figure><img src="assets/img/no-content.png" alt=""></figure>
                                            <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                            <tbody>
                                <tr *ngFor="let rates of rateCard?.additionalcardmeta">
                                    <td class="px-3 w-50">{{rates?.name}}</td>
                                    <td class="px-3 w-50" *ngIf="isTax">{{rates?.tax?.label}}</td>
                                    <td class="px-3 w-50">{{rates?.unit_of_measurement?.name }}</td>
                                    <td class="px-3 w-50">{{rates?.rate| numberFormat}}</td>
                                    <td class="px-3 w-50">{{assignVehiclecategory(rates?.vehicle_category)}}</td>

                                </tr>

                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </ng-container>

        <ng-container *ngIf="selectedTab==3">
            <div class="no-list-data-wrap mt-5" *ngIf="rateCardHeaderDetails.length==0">
                <figure><img src="assets/img/no-content.png" alt=""></figure>
                <h5 class="mt-3 primary-brand-text">No Rate Card Added!</h5>
            </div>

            <div class="def-color custom-shadow-md rounded-3 " 
                *ngFor="let rateCard of rateCardHeaderDetails;let i=index" [ngClass]="i != rateCardHeaderDetails.length -1 ? 'mb-3':''">
                <app-table-widget tableTitle="Date: {{ changeDate(rateCard?.date)}} &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" [isCollapsable]="true"
                    [isExpanded]="i<=0?true:false" (expandCollapseEvent)="expandCollapseCustomerRateCardTable($event,i)"
                    [isSearch]="false" [isExport]="false" (fileExportEvent)="fileExportEvent($event,rateCard?.id)">
                    <div id="custom-right-btn">

                        <div class="icon-box  tabIndexActive">
                            <div class="d-flex justify-content-center align-items-center">
                                <div class="position-relative">
                                    <i class="material-icons more-icon  rate-card-more"
                                        (click)="optionsList($event, 'list_'+rateCard?.id)">more_vert</i>
                                    <ul class="more-actions__menu table-popup"
                                        [ngClass]="{show: showOptions === 'list_'+rateCard?.id}">
                                        <li class="more-actions__item" *ngxPermissionsOnly="[partyPermission[1]]" (click)="editRateCard('edit',rateCard?.id)"><i
                                                class="material-icons">edit</i>Edit</li>
                                        <li class="more-actions__item" *ngxPermissionsOnly="[partyPermission[2]]" (click)="deleteRateCard(rateCard?.id)"><i
                                                class="material-icons">delete</i>Delete</li>
                                    </ul>
                                </div>
                            </div>

                        </div>
                    </div>
                </app-table-widget>


                <div class=" px-3 pb-3 " [@collapse]="isExpandCollapseForCustomerRateCard[i]">

                    <div class="addable-row-table addable-row-table-display container-rate-card-display" id="rental-rate-card-table"> 
                        <table>
                            <thead>
                                <tr>
                                    <!-- <th rowspan="2" class="text-center">
                                    </th> -->
                                    <th rowspan="2" >
                                        Port Location 
                                    </th>
                                    <th rowspan="2" >
                                        Customer Location
                                    </th>
                                    <th colspan="5" class="text-center" *ngIf="rateCard?.container_handling?.pullout">
                                        PullOut
                                    </th>
                                    <th colspan="5" class="text-center" *ngIf="rateCard?.container_handling?.deposit">
                                        Deposit
                                        </th>
                                    <th colspan="5" class="text-center" *ngIf="rateCard?.container_handling?.pullout_deposit">
                                        PullOut and Deposit
                                    </th>
                                    <th colspan="5" class="text-center" *ngIf="rateCard?.container_handling?.live_loading">
                                        Live Loading
                                    </th>
                                </tr>
                                <tr>
                                    <ng-container *ngIf="rateCard?.container_handling?.pullout">
                                        <th>
                                            Regular</th>
                                        <th>
                                            Couple</th>
                                        <th>
                                            Boggy
                                        </th>
                                        <th>
                                            Side Loader
                                        </th>
                                        <th>
                                            LowBed
                                        </th>
                                    </ng-container>
                
                                    <ng-container *ngIf="rateCard?.container_handling?.deposit" >
                                        <th>
                                            Regular </th>
                                        <th>
                                            Couple</th>
                                        <th>
                                            Boggy 
                                        </th>
                                        <th>
                                            Side Loader
                                        </th>
                                        <th>
                                            LowBed
                                        </th>
                
                                    </ng-container>
                
                
                                    <ng-container *ngIf="rateCard?.container_handling?.pullout_deposit">
                
                                        <th>
                                            Regular</th>
                                        <th>
                                            Couple</th>
                                        <th>
                                            Boggy
                                        </th>
                                        <th>
                                            Side Loader
                                        </th>
                                        <th>
                                            LowBed
                                        </th>
                
                                    </ng-container>
                
                                    <ng-container *ngIf="rateCard?.container_handling?.live_loading">
                
                                        <th>
                                            Regular</th>
                                        <th>
                                            Couple</th>
                                        <th>
                                            Boggy
                                        </th>
                                        <th>
                                            Side Loader
                                        </th>
                                        <th>
                                            LowBed
                                        </th>
                
                                    </ng-container>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let rateCardMeta of rateCard.ratecardmeta; let i = index;">
                                    <!-- <td class="text-center">
                                    </td> -->
                                    <td>{{rateCardMeta?.pullout_zone?.name}}</td>
                                    <td>{{rateCardMeta?.zone?.name}}</td>
                
                                    
                                    <ng-container *ngIf="rateCard?.container_handling?.pullout">
                                        <td>{{rateCardMeta?.pullout?.regular| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout?.couple| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout?.boggy| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout?.sideLoader| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout?.lowBed| numberFormat}}</td>
                                    </ng-container>
                
                                    <ng-container *ngIf="rateCard?.container_handling?.deposit">
                
                                        <td>{{rateCardMeta?.deposit?.regular| numberFormat}}</td>
                                        <td>{{rateCardMeta?.deposit?.couple| numberFormat}}</td>
                                        <td>{{rateCardMeta?.deposit?.boggy| numberFormat}}</td>
                                        <td>{{rateCardMeta?.deposit?.sideLoader| numberFormat}}</td>
                                        <td>{{rateCardMeta?.deposit?.lowBed| numberFormat}}</td>
                
                                    </ng-container>
                
                                    <ng-container *ngIf="rateCard?.container_handling?.pullout_deposit">
                
                                        <td>{{rateCardMeta?.pullout_deposit?.regular| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout_deposit?.couple| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout_deposit?.boggy| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout_deposit?.sideLoader| numberFormat}}</td>
                                        <td>{{rateCardMeta?.pullout_deposit?.lowBed| numberFormat}}</td>
                
                                    </ng-container>
                
                                    <ng-container *ngIf="rateCard?.container_handling?.live_loading">
                                        <td>{{rateCardMeta?.live_loading?.regular| numberFormat}}</td>
                                        <td>{{rateCardMeta?.live_loading?.couple| numberFormat}}</td>
                                        <td>{{rateCardMeta?.live_loading?.boggy| numberFormat}}</td>
                                        <td>{{rateCardMeta?.live_loading?.sideLoader| numberFormat}}</td>
                                        <td>{{rateCardMeta?.live_loading?.lowBed | numberFormat}}</td>
        
                                    </ng-container>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </ng-container>
    </div>







</div>
<alert-popup [inputData]="popupInputData" (outputData)="confirmButton($event)"></alert-popup>