<div class="container-fluid ">
    <div class="row align-items-lg-stretch def-color">
        <div class="col-12 rounded-3 layout-bg  custom-shadow-md">
            <app-table-widget class="calc-height" tableTitle="Job Stats" [selectedDateRangeType]="10" [isFilter]="true" filterUrl="report/emp/trip/filters/"
            [isDateRange]="true" [isShowDateRangeText]="true" (filterDataEmitter)="filterDataFuelStas($event)"  [isExport]="false"
            (dateRangeEmitter)="dateRangeFuelStats($event)">
            <button id="custom-export" (click)="fileExportEvent()" class="save-file ms-2">
                <span class="material-icons">save_alt</span>
           </button>
        </app-table-widget>
            <div class="row px-2 pb-3 align-items-stretch calc-height">
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card rounded-3 blue-card h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Total Jobs</span>
                            <span class="stats-icon">
                                <i class="bi bi-truck"></i>
                            </span>
                        </div>
                        <p class="fs-5 fw-bold mt-2">{{tripHistoryHead?.total_trip}}</p>
                    </div>
                </div>
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card blue-card rounded-3 h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Total No. of Vehicle</span>
                            <span class="stats-icon">
                                <i class="bi bi-truck"></i>
                            </span>
                        </div>
                        <p class="fs-5 fw-bold mt-2">{{tripHistoryHead?.vehicles}}</p>
                    </div>
                </div>
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card   rounded-3 h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Total Commission</span>
                            <span class="stats-icon">

                            </span>
                        </div>
                        <p class="fs-5 fw-bold mt-2"> {{ currency_type?.symbol}} {{tripHistoryHead?.total_allowance| numberFormat}}</p>
                        <p class="primary-brand-text fs-12px mt-2">(Average Commission - {{ currency_type?.symbol}} {{tripHistoryHead?.avg_total_allowance | numberFormat}})</p>
                    </div>
                </div>
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card blue-card  rounded-3 h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Total Job Kms</span>
                            <span class="stats-icon">
                                <i class="bi bi-truck"></i>
                            </span>
                        </div>
                        <p class="fs-5 fw-bold mt-2">{{tripHistoryHead?.total_trip_kms| numberFormat}} Kms</p>
                        <p class="primary-brand-text fs-12px mt-2">(Average Job Kms - {{tripHistoryHead?.avg_total_trip_kms| numberFormat}})</p>
                    </div>
                </div>
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card green-card green-cost-card  rounded-3 h-100" [ngClass]="tripHistoryHead?.is_profit?'green-border':'red-border'" >
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Total P/L</span>
                            <span class="stats-icon">
                                
                            </span>
                        </div>
                        <p class="fs-5 fw-bold mt-2">{{ currency_type?.symbol}} {{tripHistoryHead?.pl| numberFormat}}</p>
                        <p class="primary-brand-text fs-12px mt-2">(Average P/L - {{ currency_type?.symbol}} {{tripHistoryHead?.avg_pl| numberFormat}})</p>
                    </div>
                </div>


            </div>

            <div class="row border-top border-2 ">
                <app-table-widget tableTitle="Job Details" class="calc-height" [isSettings]="true" [isSearch]="true"
                    settingsUrl="revenue/emp/trip/report/setting/" (searchedData)="searchedDataTripList($event)"
                    (settingAppliedEmitter)="settingAppliedTrip($event)"></app-table-widget>
                <div id="trip-details-table" class="custom-table-container sticky-table-container p-0 trip_details_scroll" (scroll)="onScroll($event)">
                    <table>
                        <thead>
                            <tr>
                                <ng-container *ngFor="let header of tripHeader ; let i = index">
                                    <th class="fixed-left" *ngIf="i==0">{{header}}</th>
                                    <th *ngIf="i!=0">{{header}}</th>
                                </ng-container>
                                <th class="fixed-right icon-box ">VIEW</th>
                            </tr>
                        </thead>
                        <!-- do-data-component -->
                        <tbody *ngIf="tripList.length==0">
                            <tr class="border-0">
                                <td class="bg-white" colspan="30">
                                    <div class="no-list-data-wrap">
                                        <figure>
                                            <img src="assets/img/no-content.png" alt="">
                                        </figure>
                                        <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                    </div>
                                </td>
                            </tr>

                        </tbody>

                        <tbody>
                            <!-- Rows -->
                            <tr *ngFor="let tripDetail of tripList  ; let j = index">
                                <ng-container *ngFor="let trip of tripDetail ; let i = index">
                                    <td class="fixed-left" *ngIf="i==0 && i!=3 && i!=1">{{trip}}</td>
                                    <td  *ngIf="i ==3  &&!tripIsMarket[j] && trip !=='null'  &&  tripIsMarket[j] != null ">
                                        <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/details',tripVehicleIds[j]]"> {{trip}} </a>
                                     </td>
                                    <td *ngIf="tripIsMarket[j] || tripIsMarket[j] == null && i==3">{{trip}}</td>
                                    <td *ngIf="i!=0 && i!=1 && i!=3" [ngStyle]="getStyle(trip,i)">{{trip}}</td>
                                    <td *ngIf="i==1" [ngStyle]="getStyle(trip,i)"><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/onboarding/party/details/client/'+customerIds[j]+'/']">{{trip}}</a></td>
                                </ng-container>
                                <td class="fixed-right icon-box">
                                    <div class="justify-content-center align-items-center d-flex">
                                        <a class="sky-blue-text" target="_blank"
                                            [routerLink]="[getPrefixUrl+'/trip/new-trip/details/'+tripIds[j]+'/']">
                                            <span class="material-icons fs-4">
                                                remove_red_eye
                                            </span>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
         
           


        </div>

        
    </div>
    
</div>