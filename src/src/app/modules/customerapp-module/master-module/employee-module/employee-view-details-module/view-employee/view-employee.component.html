<div class="calc-height">
<div class="alert-msg" *ngIf="apiError">
    <span class="icon-wrap"></span>
    <p class="message-cont">{{ apiError }}</p>
</div>

<app-list-widget [tabSelectionList]="tabSelectionList" [isFilter]="true" [isExport]="true"  [isSettings]="true"     [settingsUrl]="settingsUrl"
    (listWidgetData)="listWidgetData($event)"  [isDateDropDown]="false" [isDropDown]="true" [buttonData]="buttonData" [isAddButton]="true"
    [filterUrl]="filterUrl" (exportList)="exportList($event)" (settingsApplied)="settingsApplied($event)">
    <div class="video-button me-3" id="custom-button-left">
        <button class="gb-video-play float-right" (click)="openGothrough()">
            <i class="bi bi-play-circle-fill"></i>
        </button>
        <app-go-through [goThroughDetais]="goThroughDetais"></app-go-through>
    </div>
</app-list-widget>
</div>


<div class="custom-table-container " id="employee-list" (scroll)="scrollEvent()">
    <table [ngClass]="{'h-100':employeeList.length==0}">

         <thead>
            <tr>
      
              <ng-container *ngFor="let heading of empHeader">
                <th> {{heading}} </th>
              </ng-container>
              <th class="icon-box"></th>
            </tr>
          </thead>
          <tbody *ngIf="employeeList.length == 0">
            <tr class="border-0">
              <td class="bg-white" colspan="30">
                <div class="no-list-data-wrap">
                  <figure>
                    <img src="assets/img/no-content.png" alt="">
                  </figure>
                  <h5 class="mt-3 primary-brand-text">No data found!</h5>
                </div>
              </td>
            </tr>
      
          </tbody>
        <tbody>
            <tr *ngFor="let emp of employeeList; trackBy: trackById ;">
              <ng-container *ngFor="let item of emp['extras'];let i =index">
                <td class="ws-nowrap" *ngIf="item?.name !='Display Name' &&  item?.name !='Assigned Vehicle'"> {{item?.value ? item?.value : '-'}} </td>
                <ng-container *ngIf="item?.name=='Display Name'">
                  <td>
                    <a class="custom-link"  [routerLink]="[prefixUrl+'/onboarding/employee/view',emp?.id]"  [queryParams]="{fromlist: 'employee'}" >{{item.value}} </a>
                  </td>
                </ng-container>
                <ng-container *ngIf="item?.name=='Assigned Vehicle'">
                  <td *ngIf="item?.value.length==0"> - </td>
                  <td  *ngIf="item?.value.length>0" class="td-2l">
                    <p class="text-2l">
                    <ng-container *ngFor="let vehicle of item?.value; let last = last">
                      <ng-container *ngIf="vehicle.is_market ==null">
                        <span> - </span>
                      </ng-container>
                      <ng-container *ngIf="vehicle?.is_market!=null">
                        <ng-container *ngIf="vehicle.is_market">
                          <span>
                            <a class="custom-link" target="_blank"
                            [routerLink]="[prefixUrl+'/onboarding/vehicle/market/details/',vehicle?.id]"> {{vehicle?.reg_no}} 
                          </a>{{last ? '' : ', '}}
                          </span>
                        </ng-container>
                        <ng-container *ngIf="!vehicle.is_market">
                          <span>
                            <a class="custom-link" target="_blank"
                              [routerLink]="[prefixUrl+'/onboarding/vehicle/own/details/',vehicle?.id]"> {{vehicle?.reg_no}} 
                            </a>{{last ? '' : ', '}}
                          </span>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                  </p>
                  </td>
                </ng-container>
              </ng-container>
              <td class="icon-box  tabIndexActive"  >
               <div class="d-flex justify-content-center align-items-center" >
                   <div class="position-relative">
                       <ng-container *ngIf="emp?.is_active">
                           <button class="material-icons more-icon p-0"
                               *ngxPermissionsOnly="[employeePer[1], employeePer[2]]"
                               (click)="optionsList($event, 'list_'+emp.id)">more_vert</button>
                           <div class="more-actions__menu table-popup"
                               [ngClass]="{show: showOptions === 'list_'+emp.id}">
                               <button *ngxPermissionsOnly="[employeePer[1]]"
                                   class="more-actions__item w-100 text-start"
                                   (click)="routeToEdit(emp.id)"><i
                                       class="material-icons">edit</i>Edit</button>
                               <button *ngxPermissionsOnly="[employeePer[2]]"
                                   class="more-actions__item w-100 text-start"
                                   (click)="openLastWorkingDatePopup(emp)"><i
                                       class="material-icons">delete</i>Mark Inactive</button>
                           </div>
                       </ng-container>
                 </div>
                  
               </div>

            </td>


            </tr>
        </tbody>
    </table>
</div>

<alert-popup [inputData]="popupInputData" (outputData)="confirmButton($event)"></alert-popup>