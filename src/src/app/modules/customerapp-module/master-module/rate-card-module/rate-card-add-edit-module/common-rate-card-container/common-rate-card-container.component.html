<div class=" position-relative  add-edit-quotation-wrap">
    <div class="alert alert-danger text-center "role="alert" *ngIf="apiError">
        {{apiError}}
      </div>

    <form [formGroup]="rateCardForm">
        <ng-container>
            <div>
                <div class="row px-4 pt-4">
                    <div class="col-lg-3 col-6">
                        <div class="input-wrap clearfix error" [ngClass]="addErrorClass(rateCardForm.controls.name)">
                            <label for="" class="input--required">Rate Card Name</label>
                            <input type="text" class="no-style input--bd" appRemoveSpaces formControlName="name"
                                placeholder="123456" value="">
                            <span *ngIf="nameError" class="error-reg">{{nameError}}</span>
                            <app-error [controlName]="rateCardForm.controls.name"></app-error>
                        </div>
                    </div>
                    <!-- <div class="col-lg-3 col-6">
                        <div class="input-wrap clearfix error" [ngClass]="addErrorClass(rateCardForm.controls.billing_unit)">
                            <label for="" >Billing Unit</label>
                            <material-dropdown [selectedOption]="initialValues.billingUnit" [addErrorClass]="addErrorClass(rateCardForm.controls.billing_unit)">
                                <select #customSelect formControlName="billing_unit" (change)="onBillingUnitChange()"
                                    class="no-style select--modify">
                                    <option *ngFor="let option of rateCardBillingList" value="{{ option?.value}}">
                                        {{ option?.label }}
                                    </option>
                                </select>
                            </material-dropdown>
                       </div>
                    </div> -->
                    <div class="col-lg-3 col-6">
                        <div class="input-wrap error" [ngClass]="addErrorClass(rateCardForm.controls.date)">
                            <label for="" >Date</label>
                            <mat-form-field>
                                <input matInput [matDatepicker]="date" formControlName="date" (focus)="date.open()"
                                    placeholder="DD/MM/YYYY" readonly>
                                <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
                                <mat-datepicker #date></mat-datepicker>
                            </mat-form-field>
                            <app-error [controlName]="rateCardForm.controls.date"></app-error>
                        </div>
                    </div>
                </div>

                <div class="fake-tab-bar"><span>Rental Charge</span></div>
                <div class="p-3" >
                    <div class="d-flex fw-semibold justify-content-end def-color flex-wrap mb-3">
                        <mat-checkbox class="me-3" (change)="onChangeScopeOfWork('pullout')" [formControl]="rateCardForm.get('is_pullout')"  color="primary">Pullout</mat-checkbox>
                        <mat-checkbox class="me-3" (change)="onChangeScopeOfWork('deposit')" [formControl]="rateCardForm.get('is_deposit')" color="primary">Deposit </mat-checkbox>
                        <mat-checkbox class="me-3" (change)="onChangeScopeOfWork('pullout_deposit')"  [formControl]="rateCardForm.get('is_pullout_and_deposit')" color="primary">Pullout and Deposit</mat-checkbox>
                        <mat-checkbox class="me-3" (change)="onChangeScopeOfWork('live_loading')" [formControl]="rateCardForm.get('is_liveLoading')" color="primary">Live Loading</mat-checkbox>
                    </div>
                    <div class="addable-row-table">
                        <table>
                            <thead>
                                <tr>
                                    <th class="input--required" rowspan="2">
                                        PullOut Port
                                    </th>
                                    <th class="input--required" rowspan="2">
                                        Customer Location
                                    </th>
                                    <th class="input--required" rowspan="2">
                                        Deposit Port
                                    </th>

                                    <!-- pullout -->
                                    <th class="text-center" *ngIf="rateCardForm.get('is_pullout').value" colspan="5"> 
                                       PullOut
                                    </th>

                                    <!-- deposit -->

                                    <th  class="text-center" *ngIf="rateCardForm.get('is_deposit').value" colspan="5">
                                        Deposit
                                    </th>

                                    <!-- pull out and deposit -->

                                    <th  class="text-center" *ngIf="rateCardForm.get('is_pullout_and_deposit').value"colspan="5">
                                        PullOut and Deposit                                     
                                    </th>

                                    <!-- live loading -->

                                    <th  class="text-center" *ngIf="rateCardForm.get('is_liveLoading').value" colspan="5">
                                        Live Loading                                     
                                    </th>
                                    <th class="border-top-0 border-end-0 border-bottom-0 fixed-right" rowspan="2"></th>
                                </tr>
                                <tr>
                                    <ng-container *ngIf="rateCardForm.get('is_pullout').value">
                                    <th >Regular</th>
                                    <th >Couple</th>
                                    <th >Boggy</th>
                                    <th >Side Loader</th>
                                    <th >LowBed</th>
                                    </ng-container>

                                    <ng-container *ngIf="rateCardForm.get('is_deposit').value" colspan="5">
                                    <th >Regular</th>
                                    <th >Couple</th>
                                    <th >Boggy</th>
                                    <th >Side Loader</th>
                                    <th >LowBed</th>
                                    </ng-container>

                                    <ng-container   *ngIf="rateCardForm.get('is_pullout_and_deposit').value"colspan="5">

                                    <th >Regular</th>
                                    <th >Couple</th>
                                    <th >Boggy</th>
                                    <th >Side Loader</th>
                                    <th >LowBed</th>
                                    </ng-container>

                                    <ng-container   *ngIf="rateCardForm.get('is_liveLoading').value" colspan="5">

                                    <th >Regular</th>
                                    <th >Couple</th>
                                    <th >Boggy</th>
                                    <th >Side Loader</th>
                                    <th >LowBed</th>
                                    </ng-container>
                                </tr>
                              
                            </thead>
                            <tbody formArrayName="ratecardmeta">
                                <tr *ngFor="let rateCard of rateCardForm.controls.ratecardmeta['controls']; let i = index;"
                                    [formGroupName]="i">
                                    <td>
                                        <material-dropdown
                                            [selectedOption]="initialValues.pullOut[i]"
                                            [addErrorClass]="addErrorClass(rateCard.controls.pull_out_port)">
                                            <select #customSelect formControlName="pull_out_port"
                                                class="no-style select--modify" (change)="pullOutChange(rateCard,i)">
                                                <option *ngFor="let option of zonesList" value="{{ option?.id }}">
                                                    {{ option?.name }}
                                                </option>
                                            </select>
                                        </material-dropdown>
                                    </td>
                                    <td>
                                        <material-dropdown
                                        [selectedOption]="initialValues.customer[i]"
                                        [addErrorClass]="addErrorClass(rateCard.controls.customer_location)">
                                        <select #customSelect formControlName="customer_location"
                                            class="no-style select--modify">
                                            <option *ngFor="let option of zonesList" value="{{ option?.id }}">
                                                {{ option?.name }}
                                            </option>
                                        </select>
                                    </material-dropdown>
                                       
                                    </td>
                                    <td class="disabled">
                                        <material-dropdown
                                        [selectedOption]="initialValues.deposit[i]"
                                        [disabled]="true"
                                        [addErrorClass]="addErrorClass(rateCard.controls.deposit_port)">
                                        <select #customSelect formControlName="deposit_port"
                                            class="no-style select--modify">
                                            <option *ngFor="let option of zonesList" value="{{ option?.id }}">
                                                {{ option?.name }}
                                            </option>
                                        </select>
                                    </material-dropdown>
                                       
                                    </td>

                                 <!-- pullout -->
                                  <ng-container *ngIf="rateCardForm.get('is_pullout').value" formGroupName="pullout">
                                    <td >
                                        <input type="text" class="no-style input--bd" positiveThreeDigitDecimalNumber formControlName="regular"  placeholder="123456" value=""/>  
                                    </td>
                                    <td >
                                        <input type="text" class="no-style input--bd" positiveThreeDigitDecimalNumber  formControlName="couple"  placeholder="123456" value=""/>  

                                    </td>
                                    <td >
                                        <input type="text" class="no-style input--bd" positiveThreeDigitDecimalNumber formControlName="boggy" placeholder="123456" value=""/>  

                                    </td>
                                    <td >
                                        <input type="text" class="no-style input--bd" positiveThreeDigitDecimalNumber formControlName="sideLoader"  placeholder="123456" value=""/>  

                                    </td>
                                    <td>
                                        <input type="text" class="no-style input--bd" positiveThreeDigitDecimalNumber formControlName="lowBed"   placeholder="123456" value=""/>  
                                    </td>

                                  </ng-container>

                                

                                 <!-- deposit -->

                                   <ng-container  *ngIf="rateCardForm.get('is_deposit').value" formGroupName="deposit">
                                    <td >
                                        <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="regular"  placeholder="123456" value=""/>  
                                    </td>
                                    <td >
                                        <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="couple"  placeholder="123456" value=""/>  

                                    </td>
                                    <td >
                                        <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="boggy" placeholder="123456" value=""/>  

                                    </td>
                                    <td >
                                        <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="sideLoader"  placeholder="123456" value=""/>  

                                    </td>
                                    <td>
                                        <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="lowBed"   placeholder="123456" value=""/>  
                                    </td>
                                   </ng-container>
               
                                    <!-- pull out and deposit -->
                                    <ng-container *ngIf="rateCardForm.get('is_pullout_and_deposit').value" formGroupName="pullout_deposit">
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="regular"  placeholder="123456" value=""/>  
                                        </td>
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="couple"  placeholder="123456" value=""/>  

                                        </td>
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="boggy" placeholder="123456" value=""/>  

                                        </td>
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber  class="no-style input--bd" formControlName="sideLoader"  placeholder="123456" value=""/>  

                                        </td>
                                        <td>
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="lowBed"   placeholder="123456" value=""/>  
                                        </td>
                                    </ng-container>
                                    
                                        

                                    <!-- live loading -->
                                    <ng-container *ngIf="rateCardForm.get('is_liveLoading').value"  formGroupName="live_loading"> 
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="regular"  placeholder="123456" value=""/>  
                                        </td>
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="couple"  placeholder="123456" value=""/>  

                                        </td>
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber  class="no-style input--bd" formControlName="boggy" placeholder="123456" value=""/>  

                                        </td>
                                        <td >
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="sideLoader"  placeholder="123456" value=""/>  

                                        </td>
                                        <td>
                                            <input type="text" positiveThreeDigitDecimalNumber class="no-style input--bd" formControlName="lowBed"   placeholder="123456" value=""/>  
                                        </td>
                                    </ng-container>
                                  
                                                        
                                    <td
                                    class=" border-end-0  fixed-right add-close-btn-td-sm">
                                    <div class="d-flex">

                                        <button class="  row-btn row-btn-delete " (click)="removeRateCard(i)"
                                            *ngIf="rateCardForm.controls.ratecardmeta['controls'].length !== 1"><span
                                                class="material-icons">
                                                close
                                            </span></button>
                                        <button class=" row-btn row-btn-add " (click)="addRateCard()"
                                            *ngIf="i==rateCardForm.controls.ratecardmeta['controls'].length - 1"><span
                                                class="material-icons">
                                                add
                                            </span>
                                        </button>
                                    </div>
                                </td> 
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </ng-container>
    </form>
</div>
<div class="custom-footer-bg d-flex justify-content-end py-2 px-4">
    <button class="btn  btn--sm me-3" type="button" (click)="navigateToList()">Cancel</button>
    <button class="btn btn--primary btn--sm" (click)="saveRateCard()">Save </button>
</div>