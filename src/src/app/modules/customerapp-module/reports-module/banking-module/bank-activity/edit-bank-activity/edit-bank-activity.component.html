<div class="add-screen-wrap">
    <div class="right-section__header">
      <h1 class="heading">Edit Bank Activity</h1>
    </div>
    <div class="alert-msg mg-bottom-30 flex" *ngIf="apiError">
        <span class="icon-wrap"></span>
        <div class="flex-grow-1">
          <span class="message-cont">{{ apiError }}.</span>
        </div>
        <div class="mg-right-10">
            <button type="button" class="btn btn--rounded btn-alert btn--default" (click)="patchExistingBn()">
                Add suggested bank activity number
            </button>
        </div>
    </div>
 <form [formGroup]="editBankActivityForm">
    <div class="form-layout form-layout--pd shadow-inset-top-lg">
      <div class="form-layout__card active">
        <div class="form-body">
          
          <div class="row">
            <div class="col-lg-4 col-md-6">
              <div class="input-wrap">
                <label for="">Employee</label>
                <material-dropdown [searchable]="true" [addable]="false" [selectedOption]="initialDetails?.employee">
                  <select #customSelect formControlName="employee" class="no-style select--modify">
                    <option *ngFor="let option of employeeList" value="{{ option?.id }}">
                      {{ option?.first_name }} {{ option?.last_name }}
                    </option>
                  </select>
                </material-dropdown>
                <span class="border-anim"></span>
              </div>
            </div>
            <div class="col-lg-4 col-md-6">
              <div class="input-wrap error error--type-1" [ngClass]="addErrorClass(editBankActivityForm.controls.date)">
                <label for="" class="input--required">Date</label>
                <mat-form-field class="width--100">
                  <input matInput [matDatepicker]="date" (focus)="date.open()" formControlName="date"
                    placeholder="DD/MM/YYYY">
                  <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
                  <mat-datepicker #date></mat-datepicker>
                </mat-form-field>
              </div>
            </div>
          </div>
          <div class="" id="activity-table">
            <div
              class="table-wrapper table-wrapper--type1 table-wrapper--type2  table--bd table--nobg dropDownOverflow">
              <table class="table-container">
                <thead>
                  <tr>
                    <th width=15%>Bank Activity No.</th>
                    <th width=13%>Transaction Date</th>
                    <th width=11%>Reference No.</th>
                    <th width=13%>Deposited In</th>
                    <th width=13%>Withdrawl From</th>
                    <th width=15%>Amount ({{ currency_type?.symbol}})</th>
                    <th width=9%></th>
                  </tr>
                </thead>
                <tbody formArrayName="activities">
                  <tr *ngFor="let activity of editBankActivityForm.controls.activities['controls']; let i = index;"
                    [formGroupName]="i">
                    <td class="max-wd-140">
                      <div class="input-wrap" [ngClass]="{disabled: activity.controls.id.value}">
                      <div class="select-wrap clearfix"
                        [ngClass]="addErrorClass(activity.controls.bank_activity_number)">
                        <input type="text" placeholder="" formControlName="bank_activity_number">
                      </div>
                    </div>
                    </td>
                    <td class="table-datepicker max-wd-140">
                      <div class="select-wrap clearfix"
                        [ngClass]="addErrorClass(activity.controls.transaction_date)">
                        <mat-form-field>
                          <input matInput [matDatepicker]="transactionDate" (focus)="transactionDate.open()"
                            formControlName="transaction_date" placeholder="DD/MM/YYYY">
                          <mat-datepicker-toggle matSuffix [for]="transactionDate">
                          </mat-datepicker-toggle>
                          <mat-datepicker #transactionDate></mat-datepicker>
                        </mat-form-field>
                      </div>
                    </td>
                    <td>
                      <input type="text" placeholder="" formControlName="reference_number">
                    </td>
                    <td class="max-wd-120">
                      <div class="select-wrap clearfix" [ngClass]="addErrorClass(activity.get('deposited_in'))">
                        <material-dropdown [searchable]="true" [addable]="false"
                          [selectedOption]="initialDetails?.depositedIn[i]">
                          <select #customSelect formControlName="deposited_in" class="no-style select--modify"
                          (change)="modifyWithdrawlList(activity.get('deposited_in').value,i)">
                            <option *ngFor="let option of accountdepositList[i]" value="{{ option?.id }}">
                              {{ option?.name }}</option>
                          </select>
                        </material-dropdown>
                      </div>
                    </td>
                    <td class="max-wd-120">
                      <div class="select-wrap clearfix"
                        [ngClass]="addErrorClass(activity.controls.withdrawl_from)">
                        <material-dropdown [searchable]="true" [addable]="false"
                          [selectedOption]="initialDetails?.withdrawlFrom[i]">
                          <select #customSelect formControlName="withdrawl_from" class="no-style select--modify"
                          (change)="modifyDepositList(activity.get('withdrawl_from').value,i)">
                            <option *ngFor="let option of accountWithdrawlList[i]" value="{{ option?.id }}">
                              {{ option?.name }}</option>
                          </select>
                        </material-dropdown>
                      </div>
                    </td>
                    <td>
                      <div class="select-wrap" [ngClass]="addErrorClass(activity.controls.amount)">
                        <input type="text" positiveThreeDigitDecimalNumber placeholder="1000" formControlName="amount">
                      </div>
                    </td>
                    <td class="text-center">
                      <span class="material-icons delete" (click)="removeActivity(i,activity.get('id').value)"
                        *ngIf="editBankActivityForm.controls.activities.controls.length !== 1">add_circle_outline</span>
                      <span class="material-icons add" (click)="addMoreActivity(i)">add_circle_outline</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="table-footer-actions mg-top-20">
              <a class="clear-item" (click)="clearActivities()">Clear all cells</a>
            </div>
          </div>
          <div class="form-layout__card notes mg-top-30">
            <div class="row">
              <div class="col-sm-6">
                <div class="input-wrap">
                  <label for="" class="">Description</label>
                  <input type="text" class="no-style input--bd" placeholder="Description" value=""
                    formControlName="description">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    

</form>
</div>

  <div class="custom-footer-bg px-4 py-2 d-flex justify-content-end ">
      <button class="btn btn--sm" type="button" [routerLink]="[prefixUrl+'/reports/bank-activity/list']"
      routerLinkActive="router-link-active">Cancel</button>
    <button class="btn btn--sm btn--primary ms-3" type="button"
      (click)="submitBankActivityForm()">Submit</button>
  </div>

