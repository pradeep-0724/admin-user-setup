<div class="container-fluid ">
    <div class="row align-items-lg-stretch def-color">
        <div class="col-12 rounded-3 layout-bg pb-3 custom-shadow-md">
            <app-table-widget tableTitle="Live Status"  ></app-table-widget>
            <div class="row px-2 pb-3">
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card blue-card  rounded-3 h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Scheduled Jobs (Assigned)<app-simple-tooltip [fs]="16" [ml]="2" [infoText]="'This will show the total number of scheduled jobs with vehicle assigned to it, includes both Own and Market Vehicle jobs'"></app-simple-tooltip></span>
                            <span class="stats-icon">
                                <i class="bi bi-truck"></i>
                            </span> 
                        </div>
                        <p class="fs-5 fw-bold mt-3">{{tripHistoryHead?.assigned | numberFormat }}</p>
                    </div>
                </div>
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card blue-card  rounded-3 h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Scheduled Jobs (Unassigned)<app-simple-tooltip [fs]="16" [ml]="2" [infoText]="'This will show the total number of scheduled jobs without any vehicle assigned to it'"></app-simple-tooltip></span>
                            <span class="stats-icon">
                                <i class="bi bi-truck"></i>
                            </span> 
                        </div>
                        <p class="fs-5 fw-bold mt-3">{{tripHistoryHead?.Unassigned | numberFormat}}</p>
                    </div>
                </div>
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card green-card  rounded-3 h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Ongoing Jobs</span>
                            <span class="stats-icon">
                                <i class="bi bi-truck"></i>
                            </span> 
                        </div>
                        <p class="fs-5 fw-bold mt-3">{{tripHistoryHead?.ongoing | numberFormat}}</p>
                    </div>
                </div>
                <div class="col-lg px-2 col-md-6 mt-3 mt-lg-0">
                    <div class="stats-card red-card red-cost-card rounded-3 h-100">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="fw-semibold fs-12px">Billing Pending</span>
                            <span class="stats-icon">
                            </span> 
                        </div>
                        <p class="fs-5 fw-semibold mt-3">{{tripHistoryHead?.bill_pending | numberFormat}}</p>
                            <p class="fw-semibold primary-brand-text mt-1">({{currency_type?.symbol}} {{fixedTo3Decimal(tripHistoryHead?.total_bill_pending) | numberFormat}})</p>
                        
                    </div>
                </div>



            </div>
            <div class="row border-top border-2">
                <app-table-widget tableTitle="Scheduled Jobs"[isDateRange]="true" [isShowDateRangeText]="true" 
                (dateRangeEmitter)="dateRangeScheduledTrips($event)" [selectedDateRangeType]="10"  [isSettings]="true" [isFilter]="true" settingsUrl="revenue/scheduled/trip/report/setting/"  (settingAppliedEmitter)="settingAppliedTrip($event)"
                    [isSearch]="true" (searchedData)="searchedDataScheduledList($event)" filterUrl="report/overview/trip/scheduled_filters/" (filterDataEmitter)="filterDataScheduled($event)" 
                    ></app-table-widget>
                <div class="custom-table-container sticky-table-container p-0 trip_details_scroll_trips" (scroll)="onScroll($event)">
                    <table>
                        <thead>
                            <tr>
                                <ng-container *ngFor="let header of tripHeader ; let i = index">
                                    <th class="fixed-left" *ngIf="i==0">{{header}}</th>
                                    <th  [ngClass]="{'fixed-right':i==tripHeader.length-1}" *ngIf="i!=0">{{header}}</th>
                                </ng-container>
                            </tr>
                        </thead>
                        <!-- do-data-component -->
                        <tbody  *ngIf="tripList.length==0">
                            <tr class="border-0">
                                <td class="bg-white" colspan="30">
                                    <div class="no-list-data-wrap">
                                        <figure>
                                            <img src="assets/img/no-content.png" alt="">
                                        </figure>
                                        <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                    </div>
                                </td>
                            </tr>
    
                        </tbody>

                        <ng-template #actionsTemplate let-trip let-i="i" let-j="j" >
                            <ng-container *ngIf="i==0" >
                                <td  class="fixed-left">{{trip}}</td>
                             </ng-container>   

                           

                             <ng-container *ngIf="i==this.tripList[j]?.length-1" >
                                <td  class="fixed-right">{{trip}}</td>
                             </ng-container>

                             <ng-container *ngIf="i!=this.tripList[j]?.length-1 && i!=0 " >

                                <ng-container *ngIf="this.tripHeader[i]!='Customer'&& this.tripHeader[i]!='Job ID'&& this.tripHeader[i]!='Vehicle No'" >
                                    <td >{{trip}}</td>
                                </ng-container>

                                <ng-container *ngIf="this.tripHeader[i]=='Customer'" >
                                    <td ><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/onboarding/party/details/client/'+ScheduledCustomerList[j]+'/']">{{trip}}</a></td>
                                 </ng-container>
    
                                 <ng-container *ngIf="this.tripHeader[i]=='Job ID'" >
                                    <td ><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/trip/new-trip/details/'+tripIds[j]+'/']">{{trip}}</a></td>
                                 </ng-container>  

                                 <ng-container *ngIf="this.tripHeader[i]=='Vehicle No'">
                                    <ng-container *ngIf="scheduledIsMarket[j]==null" >
                                        <td >{{trip}}</td>
                                    </ng-container>
                                    <ng-container *ngIf="scheduledIsMarket[j]==false" >
                                        <td>
                                            <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/own/details',scheduledVehicleIDs[j]]" [queryParams]="{ details: 'vehicle' }" > {{trip}} </a>
                                         </td>
                                    </ng-container>
                                    <ng-container *ngIf="scheduledIsMarket[j]==true" >
                                        <td>
                                            <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/market/details',scheduledVehicleIDs[j]]"  > {{trip}} </a>
                                         </td>
                                    </ng-container>
                                 </ng-container>




                             </ng-container>


                             
                             


                                                 </ng-template>
    
                        <tbody>
                            <!-- Rows -->
                            <tr *ngFor="let tripDetail of tripList  ; let j = index;">
                                <ng-container *ngFor="let trip of tripDetail ; let i = index;">
                                    <ng-container *ngTemplateOutlet="actionsTemplate; context: { $implicit:trip,i ,j}"></ng-container>
<!-- 
                                    <td *ngIf="i==0|| i==tripDetail.length-1" [ngClass]="{'fixed-left ':i==0,'fixed-right ':i==tripDetail.length-1}">{{trip}}</td>
                                    <td *ngIf="isOwnVech(i,j,trip) ">
                                        <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/details',scheduledVehicleIDs[j]]"  > {{trip}} </a>
                                     </td>
                                    <td  *ngIf="isMarketVehicle(i,j,trip)">{{trip}}</td>
                                    <td  *ngIf="isLink(i,trip)">{{trip}}</td>
                                    <td   *ngIf="isTrip(i)" ><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/trip/new-trip/details/'+tripIds[j]+'/']">{{trip}}</a></td>
                                    <td   *ngIf="isClient(i)"><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/onboarding/party/details/client/'+ScheduledCustomerList[j]+'/']">{{trip}}</a></td> -->

                                </ng-container>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- ///////////////ogoing trips -->
            <div class="row border-top border-2">
                <app-table-widget tableTitle="Ongoing Jobs"[selectedDateRangeType]="10"[isDateRange]="true" [isShowDateRangeText]="true" 
                (dateRangeEmitter)="dateRangeOngoingTrips($event)"  [isSettings]="true" [isFilter]="true" settingsUrl="revenue/ongoing/trip/report/setting/"  (settingAppliedEmitter)="settingAppliedOngoing($event)"
                    [isSearch]="true" (searchedData)="searchedDataOngoingList($event)" filterUrl="report/overview/trip/ongoing_filters/" (filterDataEmitter)="filterDataOngoing($event)" 
                    ></app-table-widget>
                <div class="custom-table-container sticky-table-container p-0 trip_details_ongoing_scroll" (scroll)="onScrollOngoing($event)">
                    <table>
                        <thead>
                            <tr>
                                <ng-container *ngFor="let header of ongoingTripHeader ; let i = index">
                                    <th class="fixed-left" *ngIf="i==0">{{header}}</th>
                                    <th [ngClass]="{'fixed-right':i==ongoingTripHeader.length-1}" *ngIf="i!=0">{{header}}</th>
                                </ng-container>
                            </tr>
                        </thead>
                        <!-- do-data-component -->
                        <tbody  *ngIf="ongoingTripList.length==0">
                            <tr class="border-0">
                                <td class="bg-white" colspan="30">
                                    <div class="no-list-data-wrap">
                                        <figure>
                                            <img src="assets/img/no-content.png" alt="">
                                        </figure>
                                        <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                    </div>
                                </td>
                            </tr>
    
                        </tbody>
    
                        <tbody>
                            <!-- Rows -->
                            <tr *ngFor="let tripDetail of ongoingTripList  ; let j = index">
                                <ng-container *ngFor="let trip of tripDetail ; let i = index">
                                    <td  [ngClass]="{'fixed-left ':i==0,'fixed-right ':i==tripDetail.length-2}" *ngIf="i!=4 && i!=7 && i!=8 && i!=1 &&i!=3">{{trip}}</td>
                                    <td *ngIf="!ongoingIsMarket[j] && i==1 && trip !='Unassigned'  ">
                                        <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/own/details',ongoingVehicleIDs[j]]" [queryParams]="{ details: 'vehicle' }"  > {{trip}} </a>
                                     </td>
                                    <td *ngIf="ongoingIsMarket[j] && i==1  && trip !='Unassigned' ">
                                        <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/market/details',ongoingVehicleIDs[j]]"  > {{trip}} </a>
                                    </td>
                                    <td *ngIf=" i==1  && trip =='Unassigned' ">{{trip}}</td>
                                    <td [ngClass]="{'fixed-left ':i==0,'fixed-right ':i==tripDetail.length-1}" *ngIf="i==3"><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/onboarding/party/details/client/'+OngoingCustomerList[j]+'/']">{{trip}}</a></td>

                                    <td [ngClass]="{'fixed-right ':i==tripDetail.length-2}" *ngIf="i==4"><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/trip/new-trip/details/'+ongoingTripIds[j]+'/']">{{trip}}</a></td>
                                    <td [ngClass]="{'fixed-right ':i==tripDetail.length-2}" class="text-center" *ngIf="i==7"> 
                                         
                                        <img *ngIf="tripDetail[i] && tripDetail[i+1]" (click)="openLiveTracking(ongoingTripIds[j],tripDetail[i] && tripDetail[i+1])"
                                            class="cursor-pointer" alt="" [src]="googleMaps" />
<!-- market -->
                                        <span *ngIf="tripDetail[i] && !tripDetail[i+1]" >
                                            <app-tool-tip class="point-type" [totalSlides]="GrayMapIconTooltip.content.length" position="left" [customIcon]="mapGrayIcon"
                                               [toolTipContent]="GrayMapIconTooltip">
                                              
                      
                                            </app-tool-tip>
                                        </span>

                                        <span *ngIf="!tripDetail[i] " >
                                            
                                            <app-tool-tip class="point-type" [totalSlides]="RedMapIconTooltip.content.length" position="left" [customIcon]="mapRedIcon"
                                              [toolTipContent]="RedMapIconTooltip">
                        
                                             </app-tool-tip>
                                        </span>
                          
                                        
                                        
                                        <!-- <img *ngIf="!data.is_transporter && data.is_live_track && data.is_driver_trip" (click)="openLiveTracking(data.id,data.is_live_track && data.is_driver_trip)"
                                          class="cursor-pointer" alt="" [src]="googleMaps" />
                          
                                        <ng-container *ngIf="!data.is_transporter && !data.is_driver_trip">
                                          <img class="cursor-pointer map-not-allowed" [src]="googleMaps" alt="" />
                                        </ng-container>
                                        
                                        <img *ngIf="data.is_transporter" class="cursor-pointer market-map-not-allowed" alt="" [src]="googleMaps"/> -->
                                      </td>
                                </ng-container>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- ///////billing -->
            <div class="row border-top border-2">
                <app-table-widget tableTitle="Billing Pending" [selectedDateRangeType]="10"[isDateRange]="true" [isShowDateRangeText]="true" 
                (dateRangeEmitter)="dateRangeBillingTrips($event)"  [isSettings]="true" [isFilter]="true" settingsUrl="revenue/billing/trip/report/setting/"  (settingAppliedEmitter)="settingAppliedBilling($event)"
                    [isSearch]="true" (searchedData)="searchedDataBillingList($event)" filterUrl="report/overview/trip/billing_filters/" (filterDataEmitter)="filterDataBilling($event)" 
                    ></app-table-widget>
                <div class="custom-table-container sticky-table-container p-0 trip_details_billing_scroll" (scroll)="onScrollBilling($event)">
                    <table>
                        <thead>
                            <tr>
                                <ng-container *ngFor="let header of billingTripHeader ; let i = index">
                                    <th class="fixed-left" *ngIf="i==0">{{header}}</th>
                                    <th [ngClass]="{'fixed-right':i==billingTripHeader.length-1}" *ngIf="i!=0">{{header}}</th>
                                </ng-container>
                            </tr>
                        </thead>
                        <!-- do-data-component -->
                        <tbody  *ngIf="billingTripList.length==0">
                            <tr class="border-0">
                                <td class="bg-white" colspan="30">
                                    <div class="no-list-data-wrap">
                                        <figure>
                                            <img src="assets/img/no-content.png" alt="">
                                        </figure>
                                        <h5 class="mt-3 primary-brand-text">No data found!</h5>
                                    </div>
                                </td>
                            </tr>
    
                        </tbody>
    
                        <tbody>
                            <!-- Rows -->
                            <tr *ngFor="let tripDetail of billingTripList  ; let j = index">
                                <ng-container *ngFor="let trip of tripDetail ; let i = index">
                                    <td [ngClass]="{'fixed-left ':i==0,'fixed-right ':i==tripDetail.length-1}" *ngIf="i!=4 && i !=1 && i!=3">{{trip}}</td>
                                    <td *ngIf="!billingIsmarket[j] && i==1 && trip !='Unassigned'  ">
                                        <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/own/details',billingVehicleIds[j]]" [queryParams]="{ details: 'vehicle' }"  > {{trip}} </a>
                                     </td>
                                     <td *ngIf="billingIsmarket[j] && i==1 && trip !='Unassigned'  ">
                                        <a class="custom-link "  target="_blank" [routerLink]="[prefixUrl+'/onboarding/vehicle/market/details',billingVehicleIds[j]]"  > {{trip}} </a>
                                     </td>
                                     <td  *ngIf=" i==1 && trip =='Unassigned'  ">{{trip}}</td>
                                    <td [ngClass]="{'fixed-left ':i==0,'fixed-right ':i==tripDetail.length-1}" *ngIf="i==4"><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/trip/new-trip/details/'+billingTripIds[j]+'/']">{{trip}}</a></td>
                                    <td [ngClass]="{'fixed-left ':i==0,'fixed-right ':i==tripDetail.length-1}" *ngIf="i==3"><a class="custom-link" target="_blank"  [routerLink]="[getPrefixUrl+'/onboarding/party/details/client/'+BillingPendingCustomerList[j]+'/']">{{trip}}</a></td>

                                    
                                </ng-container>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>