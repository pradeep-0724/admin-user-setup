<form [formGroup]="editNewSpareForm">
      <div class="form-layout__card mg-top-30" style="margin-left: 14px;
      margin-right: 14px;">
        <div
            class="table-wrapper table-wrapper--type1 table-wrapper--type2  table--bd table--nobg dropDownOverflow">
            <table class="table-container table-item">
                <thead>
                    <tr>
                        <th width=30%>Item Name</th>
                        <th width=15%>Quantity</th>
                        <th width=10%></th>
                        <th width=9%>Unit Cost ({{ currency_type?.symbol}})</th>
                        <th width=10%>Total ({{ currency_type?.symbol}})</th>
                        <th width=15%></th>
                    </tr>
                </thead>
                <tbody formArrayName="new_spares">
                  <ng-container *ngFor="let otherItem of editNewSpareForm.controls.new_spares['controls']; let i = index;" [formGroupName]="i">
                    <tr>
                            <td [ngClass]="{disable:itemsDisable[i]}">
                                <div>
                                  <material-dropdown [addable]="true" class="dropDownWidth" [item]="true"  [disabled]="itemsDisable[i]"
                                  class="dropDownWidth" (addItemPopup)="openAddExpenseItemModal($event, i)"
                                  [addErrorClass]="addErrorClass(otherItem.controls.item_name)"
                                  (addValueToList)="addParamsToNewSpareItem($event)"
                                  [params]="newSparesItemParams" [selectedOption]="initialValues.item[i]"
                                    >
                                        <select #customSelect formControlName="item_name"
                                            class="no-style select--modify"  (change)="onMaterialSelected(otherItem,i)"
                                            >
                                            <option *ngFor="let option of materialList"
                                                value="{{ option.id }}">
                                                {{ option.name }}
                                            </option>
                                        </select>
                                      </material-dropdown>
                                </div>
                            </td>
                            <td class="w-150" [ngClass]="{disable:itemsDisable[i]}">
                              <div class="select-wrap w-initial" [ngClass]="addErrorClass(otherItem.controls.quantity)">
                                    <input positiveThreeDigitDecimalNumber type="text" placeholder="Eg.: 1234567" [readonly]="itemsDisable[i]"
                                    formControlName="quantity" class="error-box" (change)="calculateItemAmount(i)">
                              </div>
                            </td>
                            <td [ngClass]="{disable:itemsDisable[i]}">
                                    <material-dropdown [addable]="false" class="dropDownWidth" [selectedOption]="initialValues.units[i]"  [disabled]="itemsDisable[i]"
                                    class="dropDownWidth">
                                          <select #customSelect formControlName="quantity_type"
                                              class="no-style select--modify"
                                              >
                                              <option *ngFor="let option of staticOptions.itemUnits"
                                                  value="{{ option.id }}">
                                                  {{ option.label }}
                                              </option>
                                          </select>
                                        </material-dropdown>
                                    </td>
                            <td [ngClass]="{disable:itemsDisable[i]}">
                                <input positiveThreeDigitDecimalNumber type="text" placeholder="1000" [readonly]="itemsDisable[i]" formControlName="unit_cost" (change)="calculateItemAmount(i)">
                            </td>

                            <td [ngClass]="{disable:itemsDisable[i]}">
                                <div class="input-wrap" [ngClass]="addErrorClass(otherItem.controls.total)">
                                    <input formControlName="amount" type="hidden" [readonly]="itemsDisable[i]">
                                    <input positiveThreeDigitDecimalNumber type="text" [readonly]="itemsDisable[i]" [readonly]="itemsDisable[i]" class="error-box" placeholder="1000"
                                        formControlName="total"
                                       readonly >
                                </div>
                            </td>
                                <td class="text-center">
                                  <span class="material-icons drop-down " (click)="otherItem.controls.additionalDetails.setValue(!otherItem.controls.additionalDetails.value) "
                                  *ngIf="!otherItem.controls.additionalDetails.value ">arrow_drop_down</span>
                                  <span class="material-icons drop-down " (click)="otherItem.controls.additionalDetails.setValue(!otherItem.controls.additionalDetails.value) "
                                  *ngIf="otherItem.controls.additionalDetails.value ">arrow_drop_up</span>
                                <span class="material-icons delete"
                                (click)="removeOtherItem(i)" *ngIf="editNewSpareForm.controls.new_spares[ 'length'] !==1" [ngClass]="{disable:itemsDisable[i]}">add_circle_outline</span>
                                <span class="material-icons add" *ngIf="editNewSpareForm.controls.new_spares['controls'].length -1== i"
                                (click)="addMoreOtherItem()">add_circle_outline</span>
                                <span class="material-icons add" *ngIf="editNewSpareForm.controls.new_spares['controls'].length -1== i" (click)="cloneSpareItem(otherItem)">file_copy</span>
                            </td>
                        </tr>
                        <tr class="border-top-0" *ngIf="otherItem.controls.additionalDetails.value" [ngClass]="{disable:itemsDisable[i]}">
                          <td colspan="4" class="fs-12 pt-0">
                              <input type="text" placeholder="Description" formControlName="note" [readonly]="itemsDisable[i]">
                          </td>
                          <td class="fs-12  pe-2">
                              <span class="table-footer-actions"><a class="clear-item" (click)="clearData(i)">Clear</a></span>
                          </td>
                      </tr>
                      <tr class="border-top-0">
                        <td class="fs-12 pt-0 table-footer-actions" [ngClass]="{disable:itemsDisable[i]}">
                          <p  *ngIf="!otherItem.controls.isChangeHsn.value">HSN Code: {{otherItem.controls.hsn_code.value}} <span class="clear-item" style="cursor: pointer;" (click)="otherItem.controls.isChangeHsn.setValue(!otherItem.controls.isChangeHsn.value)">change</span></p>
                            <input *ngIf="otherItem.controls.isChangeHsn.value" type="text" style="height:20px; width: 50%;" placeholder="HSN code" formControlName="hsn_code">
                        </td>
                    </tr>
                  </ng-container>
                </tbody>
            </table>
        </div>
        <div class="table-footer-actions mg-top-20" [ngClass]="{disable:itemsDisable[0]}">
            <a class="clear-item"  (click)="clearAllOtherItems()">Remove all</a>
        </div>
      </div>

    <div class="form-layout__card mg-top-30">
      <div class="table-wrapper table--nobg table-wrapper--mobile overflow-initial">
          <table class="table-container">
              <tbody>
                  <tr class="border-top-0 border-bottom-0">
                      <td width=50% class="p-0 disp-none"></td>
                      <td width=50% class="p-0">
                          <div class="table-wrapper table-wrapper--type1 table--nobg mc-expenses-wrap">
                              <table class="table-container mg-bottom-30 mc-expenses">
                                  <tbody>
                                      <tr class="border-top-0">
                                          <td width=75% class=" text-end bill-item">
                                              Subtotal:
                                          </td>
                                          <td width=25% class="rupee-symbol rupee-symbol--sm px-0  text-end bill-value">
                                            {{ currency_type?.symbol}} {{ newSparesTotal.subtotal }}
                                          </td>
                                      </tr>
                                      <tr class="border-top-0">
                                          <td width=75% class=" text-end pt-0">
                                                <div class="gst">
                                                        Discount
                                                        <div class="input-wrap">
                                                            <input positiveThreeDigitDecimalNumber type="text" class="mg-left-10 error-box" placeholder="0.00"
                                                            formControlName="discount"
                                                            (change)="onCalcuationsChanged()">
                                                        </div>
                                                        <div class="select-wrap d-inline-block">
                                                            <select name="" class="no-style select--modify custom-select"
                                                                formControlName="discount_type"
                                                                (change)="onCalcuationsChanged()">
                                                                <option value="0">%</option>
                                                                <option value="1"> {{ currency_type?.symbol}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                          </td>
                                          <td width=25% class="rupee-symbol rupee-symbol--sm px-0  text-end">
                                            {{ currency_type?.symbol}} {{ newSparesTotal.discountTotal }}
                                          </td>
                                      </tr>


                                      <tr class="border-top-0">

                                          <td width=75% class="text-start pt-0">
                                              <div class="gst">
                                                <div id="other-option">
                                                    <material-dropdown
                                                        [selectedOption]="initialValues.adjustmentAccount">
                                                        <select #customSelect formControlName="adjustment_account"
                                                            class="no-style select--modify">
                                                            <option  *ngFor="let option of expenseAccountList"
                                                                value="{{ option.id }}">{{ option.name }}
                                                            </option>
                                                        </select>
                                                    </material-dropdown>
                                                </div>
                                                  <div class="input-wrap">
                                                    <input twoDigitDecimalNumber type="text" class="error-box" placeholder="0.00"
                                                    formControlName="adjustment"
                                                    (change)="onCalcuationsChanged()">
                                                  </div>
                                                  <div class="select-wrap d-inline-block">
                                                        <select name="" class="no-style select--modify custom-select"
                                                            formControlName="adjustment_choice"
                                                            (change)="onCalcuationsChanged()">
                                                            <option value="0">%</option>
                                                            <option value="1"> {{ currency_type?.symbol}}</option>
                                                        </select>
                                                  </div>
                                            </div>
                                        </td>
                                          <td width=25% class="rupee-symbol rupee-symbol--sm px-0  text-end">
                                            {{ currency_type?.symbol}} {{ newSparesTotal.adjustmentAmount }}
                                          </td>
                                      </tr>
                                      <tr class="border-top-0">
                                          <td colspan="2" class="pt-0"></td>
                                      </tr>
                                      <tr class="">
                                          <td class=" text-end bill-total disp-w-50">
                                              Total:
                                          </td>
                                          <td width=25% class="rupee-symbol px-0  text-end bill-total">
                                            {{ currency_type?.symbol}} {{ newSparesTotal.total }} </td>
                                      </tr>

                                    <tr class="border-top-0">
                                        <td colspan="2" class="pt-0"></td>
                                    </tr>
                                    <tr>
                                        <td class=" text-end bill-total disp-w-50">
                                            Balance:
                                        </td>
                                        <td width=25% class="rupee-symbol px-0  text-end bill-total">
                                          {{ currency_type?.symbol}} {{ newSparesTotal.balance }} </td>
                                    </tr>
                                  </tbody>
                              </table>
                          </div>
                      </td>
                  </tr>
              </tbody>
          </table>
      </div>
  </div>

</form>
<app-add-expense-item [expenseItemPopDetail]="showAddExpenseItemPopup" (closeModal)="closeNewSparesItemPopup()" [units]="staticOptions.itemUnits"
  (itemAdded)="addDropDownNewSapre($event)" [isSpare]="true"></app-add-expense-item>

