<div [ngClass]="{'border-2':routeToDetail,'border-bottom':routeToDetail}">
    <app-list-widget [isFilter]="true" [isDateRangeText]="true" [isExport]="true" [isDateRange]="false" [isDropDown]="true" [isDateDropDown]="true"
      [isAddButton]="true" (exportList)="exportList($event)" [filterUrl]="filterUrl" [subtractDays]="30"  [end_date]="end_date" [start_date]="start_date"
      [tabSelectionList]="tabSelectionList" (listWidgetData)="listWidgetData($event)" [buttonData]="buttonData">
      <!-- <button class="gb-video-play me-2" id="custom-button-left" (click)="openGothrough()">
        <i class="bi bi-play-circle-fill"></i>
      </button> -->
    </app-list-widget>
    <div class="alert-msg" *ngIf="apiError">
        <span class="icon-wrap"></span>
        <p class="message-cont">{{ apiError }}</p>
</div>
  </div>
  <div class="container-fluid">
    <div class="row">
  
      <div class="custom-table-container fuel-list-height bg-white  fuel-list-wrap  p-0"
        [ngClass]="routeToDetail?'col-lg-4':'col-lg-12'" (scroll)="onScroll($event)">
        <table [ngClass]="{'h-100':invoiceList.length==0}">
          <thead *ngIf="!routeToDetail">
            <tr>
              <th>PROFORMA INVOICE DATE</th>
              <th>PROFORMA INVOICE NUMBER </th>
              <th>CUSTOMER</th>
              <th>DUE DATE</th>
              <th>TOTAL ({{currency_type.symbol}})</th>
              <th>STATUS</th>
              <th class="icon-box"></th>
            </tr>
          </thead>
          <tbody *ngIf="invoiceList.length == 0">
            <tr class="border-0">
              <td class="bg-white" colspan="30">
                <div class="no-list-data-wrap">
                  <figure>
                    <img src="assets/img/no-content.png" alt="">
                  </figure>
                  <h5 class="mt-3 primary-brand-text">No data found!</h5>
                </div>
              </td>
            </tr>
  
          </tbody>
  
          <tbody>
            <tr *ngFor="let data of invoiceList" [ngClass]="{'activated-row':selectedId==data.id && routeToDetail}">
              <ng-container *ngIf="routeToDetail">
                <td class="cursor-pointer" (click)="createQueryParems(data.id)">
                  <div class=" mb-3 fs-6 fw-semibold ">{{data.party.display_name}}</div>
                  <div>
                    <span class="link fw-medium " >{{data.invoice_number}}</span>
                    <span class="detail-date"> {{data.invoice_date}}</span>
                  </div>
                </td>
                <td class="cursor-pointer"(click)="createQueryParems(data.id)">
                  <div class=" mb-3 fs-6 fw-semibold text-end">{{currency_type.symbol}} {{data.total_amount}}</div>
                  <div class=" text-end">
                    {{data.status}}
                  </div>
  
                </td>
              </ng-container>
  
              <ng-container *ngIf="!routeToDetail">
                <td>{{data.invoice_date}}</td>
                <td><a class="custom-link" (click)="createQueryParems(data.id)">{{data.invoice_number}}</a>
                </td>
                <td><a class="custom-link" target="_blank"
                    [routerLink]="[preFixUrl+'/onboarding/party/details/client/'+data.party.id]">{{data.party.display_name}}</a>
                </td>
                <td>{{data?.due_date ?data?.due_date:'-'}}</td>
                <td>{{data.total_amount}}</td>
                <td>{{data.status}}</td>
                <td class="icon-box  ">
                    <div class="d-flex justify-content-center align-items-center">
                      <div class="position-relative">
                        <ng-container>
                            <div class="tabIndexActive"
                            *ngxPermissionsOnly="[invoicePermissions[1],invoicePermissions[2]]"><button
                                class="material-icons more-icon justify-content-center p-0"
                                (click)="optionsList($event, 'list_'+data.id)">more_vert</button></div>
                        <div class="more-actions__menu tabIndexActive table-popup"
                            [ngClass]="{show: showOptions === 'list_'+data.id}">
                            <button *ngxPermissionsOnly="invoicePermissions[1]"
                                class="more-actions__item w-100 text-start"
                                [routerLink]="[preFixUrl+'/income/performa-invoice/edit', data.id]"><i
                                    class="material-icons">edit</i>Edit</button>
                                    <ng-container  *ngIf="data.status !='Invoiced'">
                                      <button *ngxPermissionsOnly="invoicePermissions[2]"
                                      class="more-actions__item w-100 text-start"
                                      (click)="popupFunction(data.id, i)"><i
                                          class="material-icons">delete</i>Delete</button>
                                    </ng-container>        
                           <ng-container *ngIf="data.status=='Finalise'">
                            <button *ngxPermissionsOnly="invoicePermissions[0]"
                            class="more-actions__item w-100 text-start"
                            (click)="createInvoice(data.id)">Convert to Invoice</button>
                           </ng-container>
                        </div>
                        </ng-container>
                        
                      </div>
                    </div>
      
                  </td>
              </ng-container>
            </tr>
          </tbody>
        </table>
      </div>
  
      <div class="col-lg-8 p-0  pdf-viewer">
        <app-performa-invoice-details *ngIf="routeToDetail" [routeToDetail]="routeToDetail" [invoiceId]="invoiceId"
            [defaultDownload]="defaultDownload" (openDetailsEmitter)="openListDetailsData($event)" ></app-performa-invoice-details>
      </div>
  
    </div>
  </div>
  
  
  
  <alert-popup [inputData]="popupInputData" (outputData)="confirmButton($event)"></alert-popup>
  
  <app-go-through [goThroughDetais]="goThroughDetais"></app-go-through>