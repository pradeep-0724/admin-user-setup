<div class="right-section__header">
  <h1 *ngIf="!fuelActivityId" class="heading col-8">Add Fueling</h1>
  <h1 *ngIf="fuelActivityId" class="heading col-8">Edit Fueling</h1>


 
  <button class="gb-video-play float-right"  (click)="openGothrough()">
    <i class="bi bi-play-circle-fill"></i>
</button>
</div>
<form [formGroup]="addFuelForm" *ngIf="addFuelForm">
  <div class="alert-msg" *ngIf="apiError">
    <span class="icon-wrap"></span>
    <p class="message-cont">{{ apiError }}</p>
  </div>

  <div class="error-msg-list" *ngIf="globalFormErrorList.length > 0">
    <p class="message-head">{{ errorHeaderMessage }}</p>
    <span class="icon-wrap"></span>
    <ul *ngFor="let error of globalFormErrorList">
      <li class="message-cont">{{ error }}</li>
    </ul>
  </div>
  <div class="form-body shadow-inset-top-lg form-layout form-layout--pd no-br-tl no-br-tr">
    <div class="row">

      <div *ngIf="fuelActivityId" class="col-lg-3 col-sm-6">
        <div class="input-wrap disabled">
          <label for="" class="input--required position-relative">Vendor  <span *ngIf="isTdsDecleration"
              class="blueTag">TDS Declaration Received</span></label>
          <div class="input--bd">{{ initialValues.vendor.label }}</div>
          <span *ngIf="gstin" class="font-small-blue"> {{terminology.tax_no_type}}: {{gstin}} </span>
        </div>
      </div>

      <div *ngIf="!fuelActivityId" class="col-lg-3 col-sm-6">
        <div class="input-wrap error" [ngClass]="addErrorClass(addFuelForm.controls.vendor)">
          <label for="" class="input--required position-relative">Vendor <span *ngIf="isTdsDecleration"
              class="blueTag">TDS Declaration Received</span></label>
          <material-dropdown [searchable]="true" [maxLength]="255" [addable]="true" class="dropDownWidth"
            [selectedOption]="initialValues.vendor" [party]="true" (addPartyPopup)="openAddPartyModal($event)"
            (addValueToList)="addValueToPartyPopup($event)" [params]="partyNamePopup">
            <select #customSelect formControlName="vendor" class="no-style select--modify"
              (change)="onVendorSelected($event.target.value)" (change)="stopLoaderClasstoBody()">
              <option *ngFor="let vendor of vendorList" value="{{ vendor.id }}">
                {{ vendor.party_display_name }}</option>
            </select>
          </material-dropdown>
          <span *ngIf="gstin" class="font-small-blue"> {{terminology.tax_no_type}}: {{gstin}} </span>
          <app-error [controlName]="addFuelForm.controls.vendor"></app-error>
        </div>
      </div>


      <div class="col-lg-3 col-sm-6">
        <div class="input-wrap">
          <label for="">Employee In Charge</label>
          <material-dropdown [searchable]="true" [addable]="false" [selectedOption]="initialValues.employee"
            class="dropDownWidth">
            <select #customSelect (change)="handleEmployeeChange()"formControlName="employee" class="no-style select--modify">
              <option *ngFor="let employee of employeeList" value="{{ employee.id }}">
                {{ employee.emp_name_id }}</option>
            </select>
          </material-dropdown>
        </div>
      </div>
      <div class="col-lg-3 col-sm-6">
        <div class="input-wrap error" [ngClass]="addErrorClass(addFuelForm.controls.bill_number)">
          <label for="" class="input--required">Bill Number</label>
          <input type="text" class="no-style input--bd" placeholder="Eg.:1234567" value=""
            formControlName="bill_number">
          <span class="border-anim"></span>
          <app-error [controlName]="addFuelForm.controls.bill_number"></app-error>
        </div>
      </div>
      <div class="col-lg-3 col-sm-6">
        <div class="input-wrap error" [ngClass]="addErrorClass(addFuelForm.controls.bill_date)">
          <label for="" class="input--required">Bill Date</label>
          <mat-form-field>
            <input matInput readonly [matDatepicker]="bill_date" (focus)="bill_date.open()" formControlName="bill_date"
              (dateChange)="onCalendarChangePTerm($event.target?.value)" placeholder="DD/MM/YYYY">
            <mat-datepicker-toggle matSuffix [for]="bill_date"></mat-datepicker-toggle>
            <mat-datepicker #bill_date></mat-datepicker>
          </mat-form-field>
          <app-error [controlName]="addFuelForm.controls.bill_date"></app-error>
        </div>
      </div>
      <div class="col-lg-3 col-sm-6">
        <div class="input-wrap">
          <label for="" class="input">Payment Term</label>
          <material-dropdown [searchable]="true" [addable]="false" class="dropDownWidth" [addBlank]="true"
            [selectedOption]="initialValues.paymentTerm">
            <select #customSelect formControlName="payment_term" class="no-style select--modify"
              (change)="onpaymentTermSelected($event.target.value)">
              <option *ngFor="let option of staticOptions.paymentTermList" value="{{ option.id }}">
                {{ option.label }}</option>
            </select>
          </material-dropdown>
        </div>
      </div>
      <div class="col-lg-3 col-sm-6">
        <div class="input-wrap error" [ngClass]="addErrorClass(addFuelForm.controls.due_date)">
          <label for="" *ngIf="!isDueDateRequired">Due Date</label>
          <label for="" class="input--required" *ngIf="isDueDateRequired">Due Date</label>
          <mat-form-field>
            <input matInput [min]="minDate" [matDatepicker]="due_date" (focus)="due_date.open()"
            (dateChange)="onWorkEndDateChange()" formControlName="due_date" placeholder="DD/MM/YYYY">
            <mat-datepicker-toggle matSuffix [for]="due_date"></mat-datepicker-toggle>
            <mat-datepicker #due_date></mat-datepicker>
          </mat-form-field>
          <app-error [controlName]="addFuelForm.controls.due_date"></app-error>
        </div>
      </div> 
    </div>
    <app-tax-inclusive [taxInclusiveForm]="addFuelForm"  [editData]="editData" [partyDetails]="partyTaxDetails" [ngClass]="{'hiddenContent':!isTax}"
    (taxInclusiveFormValueChange)="headerTaxDetails($event)"
    [isValidForm]="taxFormValid">
    </app-tax-inclusive>
    <div class="form-layout__card mg-top-30">
      <ng-container>
        <div class="form-layout__header">
          <h2 class="sub-heading">Fuel Purchase</h2>
          <span class="collapse-line"></span>
        </div>
        <div class="challan-header p-0" style="display: -webkit-inline-box;">
          <div class="input-group input-group-sm mb-3 input-wrap error"
            [ngClass]="addErrorClass(addFuelForm.controls.hsn_code)">
            <div class="input-group-prepend">
              <span class="input-group-text" id="inputGroup-sizing-sm">HSN Code
              </span>
            </div>
            <input type="text" class="form-control error-box" aria-label="Small" aria-describedby="inputGroup-sizing-sm"
              placeholder="Add HSN Code" formControlName="hsn_code">
            <app-error [controlName]="addFuelForm.controls.hsn_code"></app-error>
          </div>
          <div class="input-group input-group-sm ms-3 mb-3 input-wrap"
            [ngClass]="{disable:disableTax || !companyRegistered}">
            <div class="input-group-prepend" [ngClass]="{'hiddenContent':!isTds}">
              <span class="input-group-text" id="inputGroup-sizing-tax">Tax
              </span>
            </div>
            <material-dropdown [ngClass]="{'hiddenContent':!isTds}" [selectedOption]="initialValues.mainTaxSelection"
              [searchable]="true" [disabled]="disableTax || !companyRegistered" [addable]="false"
              class="dropDownWidth form-control">
              <select #customSelect formControlName="tax" class="no-style select--modify"
                (change)="onSelectPopulateTax($event)">
                <option *ngFor="let option of taxOptions" value="{{ option.id }}">
                  {{ option.label }}
                </option>
              </select>
            </material-dropdown>

          </div>
        </div>
      </ng-container>

      <div class="mg-top-30" *ngIf="unpaidChallanList.length > 0">
        <div class="table-wrapper table-wrapper--type1 table-wrapper--type2 table--bd table--nobg">
          <table class="table-container">
            <thead>
              <tr class="desktop_th">
                <th width=15%>Vehicle No.</th>
                <th width=10%>Fuel Quantity</th>
                <th width=9%>Fuel Cost ({{ currency_type?.symbol}})</th>
                <th [ngClass]="{'hiddenContent':!isTds}">Amount  ({{ currency_type?.symbol}})</th>
                <th [ngClass]="{'hiddenContent':!isTds}">Tax</th>
                <th width=10%>Total ({{ currency_type?.symbol}})</th>
                <th width=10%>Date </th>
                <th width=10%>Document No.</th>
                <th width=8%></th>
              </tr>
            </thead>
            <tbody formArrayName="unpaid_fuel_details">
              <tr class="mobile-flex"
                *ngFor="let challan of addFuelForm.get('unpaid_fuel_details').controls;let i = index;"
                [formGroupName]="i">

                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Vehicle No.</h5>
                  <div class="filledData"> {{ challan.value?.vehicle?.reg_number }} </div>
                </td>
                <td class="max-wd-120 input-wrap" [ngClass]="addErrorClass(challan.controls.quantity)">
                  <h5 class="th_h5_mobile">Fuel Quantity</h5>
                  <div>
                    <input type="text" placeholder="0" class="error-box" positiveThreeDigitDecimalNumber
                      formControlName="quantity" (change)="calculateUnpaidTotal(challan);">
                  </div>
                </td>
                <td class="max-wd-120 input-wrap" [ngClass]="addErrorClass(challan.controls.unit_cost)">
                  <h5 class="th_h5_mobile">Fuel Cost</h5>
                  <div>
                    <input type="text" positiveThreeDigitDecimalNumber placeholder="0" class="error-box"
                      formControlName="unit_cost" (change)="calculateUnpaidTotal(challan);">
                  </div>
                </td>
                <td class="max-wd-120" [ngClass]="{'hiddenContent':!isTds}">
                  <h5 class="th_h5_mobile">Amount</h5>
                  <div class="filledData"> {{ challan.value?.total_before_tax }}</div>
                </td>
                <td class="max-wd-120" [ngClass]="{'hiddenContent':!isTds}">
                  <h5 class="th_h5_mobile">Tax</h5>
                  <div [ngClass]="{disable:disableTax || !companyRegistered}">
                    <div class="select-wrap">
                      <material-dropdown [searchable]="true" [addable]="false" class="dropDownWidth"
                        [selectedOption]="initialValues.umpaidFuelChallanTax[i]"
                        [disabled]="disableTax || !companyRegistered">
                        <select #customSelect formControlName="tax" class="no-style select--modify"
                          (change)="calculationsChanged()">
                          <option *ngFor="let option of taxOptions" value="{{ option.id }}">
                            {{ option.label }}
                          </option>
                        </select>
                      </material-dropdown>
                    </div>
                  </div>
                </td>
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Total</h5>
                  <div class="filledData"> {{ challan.value?.total }}</div>
                </td>
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Date</h5>
                  <div class="table-datepicker">
                    <mat-form-field>
                      <input matInput readonly [matDatepicker]="date" (focus)="date.open()" formControlName="date"
                        placeholder="DD/MM/YYYY">
                      <mat-datepicker-toggle matSuffix [for]="date"></mat-datepicker-toggle>
                      <mat-datepicker #date></mat-datepicker>
                    </mat-form-field>
                  </div>
                </td>
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Document No.</h5>
                  <div>
                    <input type="text" placeholder="0" formControlName="document_no">
                  </div>
                </td>
              </tr>
              <tr *ngIf="unpaidFuelDetailsTotal.total>0">
                <td>
                  <div class="filledData d-flex align-items-center fw-semibold  sum-border">Total</div>
                </td>
                <td>
                  <div class="sum d-flex align-items-center fw-semibold sum-border">
                    {{unpaidFuelDetailsTotal.totalQuantity}}</div>
                </td>
                <td></td>
                <td [ngClass]="{'hiddenContent':!isTds}">
                  <div class="sum d-flex align-items-center fw-semibold sum-border">
                    {{unpaidFuelDetailsTotal.totalAmount}}</div>
                </td>
                <td [ngClass]="{'hiddenContent':!isTds}"></td>
                <td>
                  <div class="sum d-flex align-items-center fw-semibold fw-medium sum-border">
                    {{unpaidFuelDetailsTotal.total }}
                  </div>
                </td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>

      </div>

      <div class="my-2">
        <app-add-vehicle-fuel-challan [alreadySelectedChallans]="unpaidChallanList"
          [inlineAdd]="unpaidChallanModelInline" [isAdd]="isAdd"
          (onAddChallanClicked)="challansSelectedVehicleFuel($event)"
          (checkChallanExist)="checkUnpaidChallanExist($event)"></app-add-vehicle-fuel-challan>
      </div>

    </div>

    <div class="form-layout__card mg-top-30">

      <div class="mg-top-30">
        <div class="table-wrapper table-wrapper--type1 table-wrapper--type2  table--bd table--nobg dropDownOverflow"
          id="table-wrapper">
          <table class="table-container">
            <thead>
              <tr class="desktop_th">
                <th width=15%>Vehicle No.</th>
                <th width=10%>Fuel Quantity</th>
                <th width=9%>Fuel Cost ({{ currency_type?.symbol}})</th>
                <th [ngClass]="{'hiddenContent':!isTds}">Amount</th>
                <th [ngClass]="{'hiddenContent':!isTds}">Tax</th>
                <th width=10%>Total ({{ currency_type?.symbol}})</th>
                <th width=10%>Date </th>
                <th width=10%>Document No.</th>
                <th width=8%></th>
              </tr>
            </thead>
            <tbody formArrayName="vehicle_details">
              <tr class="mobile-flex"
                *ngFor="let vehicleItem of addFuelForm.controls.vehicle_details.controls; let i = index;"
                [formGroupName]="i">
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Vehicle No. </h5>
                  <div>
                    <material-dropdown [searchable]="true" [addable]="false" [selectedOption]="initialValues.vehicle[i]"
                      [addErrorClass]="addErrorClass(vehicleItem.controls.vehicle)">
                      <select #customSelect formControlName="vehicle" class="no-style select--modify" (change)="addDefaultDateToNewRow(vehicleItem,i)">
                        <option *ngFor="let option of vehicleList" value="{{ option?.id }}">
                          {{ option?.reg_number }}
                        </option>
                      </select>
                    </material-dropdown>
                  </div>
                </td>

                <td class="input-wrap max-wd-120" [ngClass]="addErrorClass(vehicleItem.controls.quantity)">
                  <h5 class="th_h5_mobile">Fuel Quantity </h5>
                  <input positiveThreeDigitDecimalNumber type="text" placeholder="Eg.: 1234567" class="error-box"
                    formControlName="quantity" (change)="populateFuelRate(i);calculateVehicleDetailsAmount(i)">
                </td>

                <td class="max-wd-120 input-wrap" [ngClass]="addErrorClass(vehicleItem.controls.unit_cost)">
                  <h5 class="th_h5_mobile"> Fuel Cost</h5>
                  <input positiveThreeDigitDecimalNumber type="text" class="error-box" placeholder="1000"
                    formControlName="unit_cost" (change)="calculateVehicleDetailsAmount(i)">
                </td>

                <td class="max-wd-120" [ngClass]="{'hiddenContent':!isTds}">
                  <h5 class="th_h5_mobile">Amount ({{ currency_type?.symbol}}) </h5>
                  <div class="input-wrap disabled">
                    <input type="number" placeholder="1000" formControlName="total_before_tax" [attr.disabled]="true">
                  </div>
                </td>

                <td class="max-wd-120" [ngClass]="{'hiddenContent':!isTds}">
                  <h5 class="th_h5_mobile">Tax</h5>
                  <div [ngClass]="{disable:disableTax || !companyRegistered}">
                    <div class="select-wrap">
                      <material-dropdown [searchable]="true" [addable]="false" class="dropDownWidth"
                        [selectedOption]="initialValues.fuelTax[i]" [disabled]="disableTax || !companyRegistered">
                        <select #customSelect formControlName="tax" class="no-style select--modify"
                          (change)="calculationsChanged()">
                          <option *ngFor="let option of taxOptions" value="{{ option.id }}">
                            {{ option.label }}
                          </option>
                        </select>
                      </material-dropdown>
                    </div>
                  </div>
                </td>

                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Total ({{ currency_type?.symbol}}) </h5>
                  <div class="input-wrap disabled">
                    <input type="number" placeholder="1000" formControlName="total" [attr.disabled]="true">
                  </div>
                </td>
                <td class="table-datepicker max-wd-140 max-wd-120">
                  <h5 class="th_h5_mobile">Date </h5>
                  <mat-form-field>
                    <input matInput readonly [matDatepicker]="transactionDate3" (focus)="transactionDate3.open()"
                      formControlName="date" placeholder="DD/MM/YYYY">
                    <mat-datepicker-toggle matSuffix [for]="transactionDate3">
                    </mat-datepicker-toggle>
                    <mat-datepicker #transactionDate3></mat-datepicker>
                  </mat-form-field>
                </td>

                <td class="max-wd-120">
                  <h5 class="th_h5_mobile"> Document No.</h5>
                  <input type="text" placeholder="1000" formControlName="document_no">
                </td>

                <td class="max-wd-120 mobile-width-100">
                  <span class="material-icons clear"
                    (click)="resetVehicleDetail(vehicleItem, i)">remove_circle_outline</span>
                  <span class="material-icons delete" (click)="removeVehicleDetail(i)"
                    *ngIf="addFuelForm.controls.vehicle_details.controls.length !== 1">add_circle_outline</span>
                  <span class="material-icons add" (click)="addMoreVehicleDetails()" >add_circle_outline</span>
                </td>
              </tr>
              <tr *ngIf="vehicleDetailsTotal.total>0">
                <td>
                  <div class="filledData d-flex align-items-center fw-semibold  sum-border">Total</div>
                </td>
                <td>
                  <div class="sum d-flex align-items-center fw-semibold sum-border">
                    {{vehicleDetailsTotal.totalQuantity}}</div>
                </td>
                <td></td>
                <td [ngClass]="{'hiddenContent':!isTds}">
                  <div class="sum d-flex align-items-center fw-semibold sum-border">{{vehicleDetailsTotal.totalAmount}}
                  </div>
                </td>
                <td [ngClass]="{'hiddenContent':!isTds}"></td>
                <td>
                  <div class="sum d-flex align-items-center fw-semibold sum-border">{{vehicleDetailsTotal.total }}</div>
                </td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="table-footer-actions mg-top-20">
          <a class="clear-item" (click)="clearAllVehicleDetails()">Remove all</a>
        </div>
      </div>
    </div>

    <div class="form-layout__card mg-top-30">
      <div class="form-layout__header">
        <h2 class="sub-heading">Item Others</h2>
        <span class="collapse-line"></span>
      </div>
      <div class="mg-top-30">
        <div class="table-wrapper table-wrapper--type1 table-wrapper--type2  table--bd table--nobg dropDownOverflow">
          <table class="table-container">
            <thead>
              <tr class="desktop_th">
                <th width=10%>Item</th>
                <th width=15%>Expense Account</th>
                <th width=9%>Total units</th>
                <th width=10%>Unit</th>
                <th width=10%>Rate per unit ({{ currency_type?.symbol}})</th>
                <th width=10% [ngClass]="{'hiddenContent':!isTax}">Amount ({{ currency_type?.symbol}})</th>
                <th width=18% [ngClass]="{'hiddenContent':!isTax}">Tax</th>
                <th width=10%>Total ({{ currency_type?.symbol}})</th>
                <th width=8%></th>
              </tr>
            </thead>
            <tbody formArrayName="other_expenses">
              <tr class="mobile-flex"
                *ngFor="let otherItem of addFuelForm.controls.other_expenses.controls; let i = index;"
                [formGroupName]="i">
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Item</h5>
                  <div>
                    <material-dropdown [searchable]="true" [addable]="true" class="dropDownWidth" [addBlank]="false"
                    [addErrorClass]="addErrorClass(otherItem.controls.item)" [maxLength]="20"
                    [selectedOption]="initialValues?.items[i]" [addNewOptions]="true"
                    (addNewOption)="addNewAdditionalCharge($event,i)">
                    <select #customSelect formControlName="item" class="no-style select--modify" (change)="onMaterialSelected(otherItem,i);">
                        <option *ngFor="let option of staticOptions.materialList" value="{{ option?.id }}">
                          {{ option.name }}
                        </option>
                    </select>
                  </material-dropdown>

                  </div>
                </td>
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Expense Account</h5>
                  <div class="select-wrap w-initial">
                    <material-dropdown [searchable]="true" [addable]="true" class="dropDownWidth" [params]="coaParams"
                      (addValueToList)="addParamsCoaItem($event)" [chartOfAccount]="true"
                      (addChartOfAccount)="openAddCoaModal($event, i)"
                      [addErrorClass]="addErrorClass(otherItem.controls.expense_account)"
                      [selectedOption]="initialValues.expenseAccount[i]">
                      <select #customSelect formControlName="expense_account" class="no-style select--modify">
                        <option *ngFor="let account of accountList" value="{{ account.id }}">
                          {{ account.name }}</option>
                      </select>
                    </material-dropdown>
                  </div>
                </td>
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Total units</h5>
                  <div class="input-wrap" [ngClass]="addErrorClass(otherItem.controls.quantity)">
                    <input positiveThreeDigitDecimalNumber type="text" class="error-box" placeholder="Eg.: 1234567"
                      formControlName="quantity" (change)="calculateItemOthersAmount(i)">
                  </div>

                </td>
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Unit</h5>
                  <div class="select-wrap">
                    <material-dropdown [searchable]="true" [addable]="false" [addBlank]="true" class="dropDownWidth"
                      [selectedOption]="initialValues.units[i]"
                      [addErrorClass]="addErrorClass(otherItem.controls.unit)">
                      <select #customSelect formControlName="unit" class="no-style select--modify">
                        <option *ngFor="let option of staticOptions.itemUnits" value="{{ option.id }}">
                          {{ option.label }}
                        </option>
                      </select>
                    </material-dropdown>
                  </div>
                </td>
                <td class="max-wd-120">
                  <h5 class="th_h5_mobile">Rate per unit ({{ currency_type?.symbol}})</h5>
                  <div class="input-wrap" [ngClass]="addErrorClass(otherItem.controls.unit_cost)">
                    <input positiveThreeDigitDecimalNumber type="text" class="error-box" placeholder="1000"
                      formControlName="unit_cost" (change)="calculateItemOthersAmount(i)">
                  </div>

                </td>
                <td class="max-wd-120" [ngClass]="{'hiddenContent':!isTax}">
                  <h5 class="th_h5_mobile">Amount ({{ currency_type?.symbol}})</h5>
                  <div class="input-wrap" [ngClass]="addErrorClass(otherItem.controls.total_before_tax)">
                    <input positiveThreeDigitDecimalNumber readonly type="text" class="error-box" placeholder="1000"
                      formControlName="total_before_tax" (change)="calculateItemOther(i)">
                  </div>
                </td>
                <td class="max-wd-120" [ngClass]="{'hiddenContent':!isTax}">
                  <h5 class="th_h5_mobile">Tax</h5>
                  <div [ngClass]="{disable:disableTax || !companyRegistered}">
                    <div class="select-wrap">
                      <material-dropdown [searchable]="true" [addable]="false" class="dropDownWidth"
                        [selectedOption]="initialValues.tax[i]" [disabled]="disableTax || !companyRegistered">
                        <select #customSelect formControlName="tax" class="no-style select--modify"
                          (change)="calculationsChanged()">
                          <option *ngFor="let option of taxOptions" value="{{ option.id }}">
                            {{ option.label }}
                          </option>
                        </select>
                      </material-dropdown>
                    </div>
                  </div>
                </td>
                <td class="max-wd-120">
                  <div class="input-wrap disabled">
                    <h5 class="th_h5_mobile">Total ({{ currency_type?.symbol}})</h5>
                    <input type="number" placeholder="1000" formControlName="total" [attr.disabled]="true">
                  </div>
                </td>
                <td class="mobile-width-100 max-wd-120">
                  <span class="material-icons clear" (click)="resetOtherItem(otherItem, i)">remove_circle_outline</span>
                  <span class="material-icons delete" (click)="removeOtherItem(i)"
                    *ngIf="addFuelForm.controls.other_expenses.controls.length !== 1">add_circle_outline</span>
                  <span class="material-icons add" (click)="addMoreOtherItem()">add_circle_outline</span>
                </td>
              </tr>
              <tr *ngIf="itemOthersTotal.total>0">
                <td></td>
                <td>
                  <div class="filledData d-flex align-items-center fw-semibold  sum-border">Total</div>
                </td>
                <td>
                  <div class="sum d-flex align-items-center fw-semibold sum-border">{{itemOthersTotal.totalQuantity}}
                  </div>
                </td>
                <td></td>
                <td></td>
                <td [ngClass]="{'hiddenContent':!isTax}">
                  <div class="sum d-flex align-items-center fw-semibold sum-border">{{itemOthersTotal.totalAmount }}
                  </div>
                </td>
                <td [ngClass]="{'hiddenContent':!isTax}"></td>
                <td>
                  <div class="sum d-flex align-items-center fw-semibold sum-border">{{itemOthersTotal.total}}</div>
                </td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="table-footer-actions mg-top-20">
          <a class="clear-item" (click)="clearAllOtherItems()">Remove all</a>
        </div>
      </div>
    </div>

    <div class="gst-table-wrapper mg-top-30">

      <div class="gst-main">
        <div class="text-end fw-bold gst-left"> Subtotal Fuel Purchase: </div>
        <div class="px-0  text-end fw-bold gst-right">{{ currency_type?.symbol}} {{totals.subtotal_challan | numberFormat}}</div>
      </div>
      <div class="gst-main">
        <div class="text-end fw-bold gst-left">Subtotal Others: </div>
        <div class="px-0  text-end fw-bold gst-right">{{ currency_type?.symbol}} {{totals.subtotal_others | numberFormat}}</div>
      </div>
      <div class="gst-main" *ngIf="totals.totalFuelQuantity">
        <div class="text-end fw-bold gst-left">Total Fuel Quantity: </div>
        <div class="px-0  text-end fw-bold gst-right">{{totals.totalFuelQuantity | numberFormat}}</div>
      </div>
      <div class="gst-main" *ngIf="totals.totalItemQuantity">
        <div class="text-end fw-bold gst-left">Total Item Quantity: </div>
        <div class="px-0  text-end fw-bold gst-right">{{totals.totalItemQuantity | numberFormat}}</div>
      </div>
      <div class="gst-main" [ngStyle]="{ 'display': 'none'  }">
        <div class="text-end pt-0 gst-left">
          <span> Discount</span>
          <div class="input" [ngClass]="addErrorClass(addFuelForm.controls.discount)">
            <input positiveThreeDigitDecimalNumber type="text" class="error-box" placeholder="0.00"
              formControlName="discount" (change)="calculationsChanged()">
          </div>
          <div class="select-wrap dropdown">
            <select name="" class="no-style select--modify custom-select" formControlName="discount_type"
              (change)="calculationsChanged()">
              <option value="0">%</option>
              <option value="1"> {{ currency_type?.symbol}} </option>
            </select>
          </div>
        </div>
        <div class="px-0  text-end gst-right"> {{ currency_type?.symbol}} {{ totals.discountTotal | numberFormat}}</div>
      </div>
      <div class="gst-main" *ngFor="let percentageTotal of totals.taxes;" [ngClass]="{'hiddenContent':!isTax}">
        <ng-container *ngIf="percentageTotal.total && percentageTotal.taxAmount>0">
          <div class="text-end gst-left"> Include {{terminology.tax_type}} &#64; {{ percentageTotal.value }}% on
            <span class="rupee-symbol rupee-symbol--sm">{{ percentageTotal.total | numberFormat}}</span>:
          </div>
          <div class="px-0  text-end gst-right"> {{ currency_type?.symbol}} {{ percentageTotal.taxAmount | numberFormat}} </div>
        </ng-container>
      </div> 
      <div class="gst-main" [ngClass]="{'hiddenContent':!isTax}">
        <div class="gst-left text-end pt-0">
          <span>Discount after Tax </span>
          <div class="input" [ngClass]="addErrorClass(addFuelForm.controls.discount_after_tax)"
            [class.disabled]="disableTax || !companyRegistered">
            <input positiveThreeDigitDecimalNumber type="text" class="error-box" placeholder="0.00"
              formControlName="discount_after_tax" [attr.disabled]="disableTax || !companyRegistered ? '': null"
              (change)="calculationsChanged()">
          </div>
          <div class="select-wrap dropdown">
            <select name="" class="no-style select--modify custom-select" formControlName="discount_after_tax_type"
              (change)="calculationsChanged()">
              <option value="0">%</option>
              <option value="1">{{ currency_type?.symbol}}</option>
            </select>
          </div>
        </div>
        <div class="px-0 gst-right text-end">{{ currency_type?.symbol}} {{ totals.discountAfterTaxTotal | numberFormat}}</div>
      </div>


      <div class="gst-main">
        <div class="text-start pt-0 gst-left">

          <div class="dropdown select-wrap">
            <material-dropdown [selectedOption]="initialValues.adjustmentAccount">
              <select #customSelect formControlName="adjustment_account" class="no-style select--modify">
                <option *ngFor="let option of expenseAccountList" value="{{ option.id }}">
                  {{ option.name }}
                </option>
              </select>
            </material-dropdown>

          </div>
          <div class="input" [ngClass]="addErrorClass(addFuelForm.controls.adjustment)">
            <input positiveThreeDigitDecimalNumber type="text" class="error-box" placeholder="0.00"
              formControlName="adjustment" (change)="calculationsChanged()">
          </div>
          <div class="select-wrap d-inline-block">
            <select name="" class="no-style select--modify custom-select" formControlName="adjustment_choice"
              (change)="calculationsChanged()">
              <option value="0">%</option>
              <option value="1"> {{ currency_type?.symbol}} </option>
            </select>
          </div>
        </div>
        <div class="px-0  text-end gst-right">{{ currency_type?.symbol}} {{ totals.adjustmentAmount | numberFormat}}</div>
      </div>
      <div class="text-end gst-main">
        <div class="text-end h5"> <strong> Total: </strong></div>
        <div class="px-0 text-end ms-3 h5"><strong>{{ currency_type?.symbol}} {{ totals.total | numberFormat}} </strong></div>
      </div>
      <div class="gst-main" [ngClass]="{'hiddenContent':!isTax||isTds}">
        <div class="text-end pt-0 gst-left">

          <app-last-section-inputfield-box [lastSectionTaxDetails]="lastSectionTaxDetails"
            [lastSectionEditData]="lastSectionEditData"
            (lastSectionOutPut)="lastSectionOutPut($event)"></app-last-section-inputfield-box>
        </div>
        <div class="px-0 gst-right text-end"> {{ currency_type?.symbol}} {{ totals.tdsAmount | numberFormat}}</div>
      </div>
      <div class="text-end gst-main">
        <div class="text-end h5"><strong> Balance: </strong></div>
        <div class="px-0 text-end ms-3 h5"> <strong>{{ currency_type?.symbol}} {{ totals.balance | numberFormat }} </strong></div>
      </div>
    </div>
    <hr>
    <app-payment-status [vendorId]="addFuelForm.get('vendor').value" [balanceAmount]="totals.balance"
      [billDate]="addFuelForm.get('bill_date').value" [vendorList]="vendorList"
      [$paymentStatusValid]="$paymentStatusValid" [editPayemntStatusData]="mechanicActivityData"
      (paymentStatusData)="paymentStatusData($event)">

    </app-payment-status>

    <div class="col-sm-12">
      <div class="row">
        <div class="col-sm-6">
          <div class="row">
            <div class="col-sm-8">
              <div class="input-wrap mb-0 pb-3">
                <label for="">Remind Date</label>
                <mat-form-field>
                  <input matInput [matDatepicker]="reminder" formControlName="reminder" (focus)="reminder.open()"
                    placeholder="DD/MM/YYYY">
                  <mat-datepicker-toggle matSuffix [for]="reminder"></mat-datepicker-toggle>
                  <mat-datepicker #reminder></mat-datepicker>
                </mat-form-field>
                <span class="error-message">Error messge!</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="input-wrap mb-0 pb-3">
            <label for="" class="">Optional Comment</label>
            <input type="text" class="no-style input--bd" placeholder="Comments" formControlName="comments">
          </div>
        </div>
      </div>
    </div>

    <div class="form-layout__card mg-top-30">
      <file-uploader (onFileUploaded)="fileUploader($event)" (onFileDeleted)="fileDeleted($event)" [multiple]="true"
        [accept]="'capture=camera, image/jpeg,image/x-jpg,image/png, application/pdf'" [showFileName]="false"
        [patchFileUrls]="patchFileUrls">
      </file-uploader>
    </div>
  </div>
  <div class="footer-bg p-2 px-4 custom-footer-bg d-flex justify-content-end">

    <button class="btn btn--sm me-2" [routerLink]="[prefixUrl+'/expense/fuel_expense/list']"
      routerLinkActive="active">Cancel</button>
    <button class="btn btn--primary " (click)="saveExpense()">{{fuelActivityId?'Update':'Save'}} Expense</button>

  </div>
</form>
<add-new-coa [popDetail]="showAddCoaPopup" [isExpenseType]="true" (closeModal)="closeCoaPopup"
  (coaAdded)="addExpenseToOption($event)">
</add-new-coa>

<!-- Popup for adding party details -->
<app-add-party-popup [popDetail]="showAddPartyPopup" (closeModal)="closePartyPopup()"
  (partyAdded)="addPartyToOption($event)" [isVendor]="true"></app-add-party-popup>



  <!-- video-popup -->
  <app-go-through  [goThroughDetais]="goThroughDetais"></app-go-through>
