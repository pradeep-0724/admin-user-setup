<div>
  <div class="right-section__header">

    <div class="d-flex align-items-center">
      <p class="trip-id"><button (click)="historyBack()"><i
            class="bi bi-chevron-left"></i></button>{{workOrderDetail?.workorder_no}}&nbsp; {{workOrderDetail?.quotation?.quotation_no}} &nbsp;
        </p>
      <div  class="header-chip header-chip-green trailer-chip" *ngIf="workOrderDetail?.vehicle_category ==0"><img  src="../../../../../../../assets/img/icons/loose-cargo-green.png" alt="">  Loose Cargo</div>
      <div  class="header-chip header-chip-green trailer-chip" *ngIf="workOrderDetail?.vehicle_category == 4"><img  src="../../../../../../../assets/img/icons/containr-green.png" alt="">  Container</div>


    </div>
    <div class="d-flex align-items-center" [ngClass]="{'disabled': workOrderDetail?.closed_status === 'Closed'}">
      <ng-container
        *ngIf="workOrderDetail.status.status_screen_to_show !=='void'">
          <button class="gb-edit-btn-secondary ms-2"  *ngIf="isSOEdit" [routerLink]="[prefixUrl+'/trip/work-order/edit',workOrderId]">
            <span  class="material-icons"> create </span>Edit</button>
      </ng-container>
      <ng-container *ngIf="workOrderDetail.status.status_screen_to_show =='approved'">
          <button class="gb-btn gb-btn-basic ms-2 " *ngIf="workOrderDetail?.vehicle_category==0" (click)="createJobForCargo()">Schedule Job</button>
          <button class="gb-btn gb-btn-basic ms-2 " *ngIf="workOrderDetail?.vehicle_category<=2" (click)="createMultipleTrip()">Schedule Multiple
            Jobs</button>

          <ng-container *ngIf="workOrderDetail?.vehicle_category==4">
            <ng-container *ngIf="workOrderDetail?.type_of_movement=='Import' || workOrderDetail?.type_of_movement=='Export' else normalType">

              <button mat-button class="btn btn--primary ms-2 position-relative pe-4 btn--sm"  *ngIf="workOrderDetail?.movement_sow=='Pullout'" [matMenuTriggerFor]="menu1">Schedule <i
                class="material-icons schedule-arrow"> arrow_drop_down</i></button>
              <mat-menu #menu1="matMenu">
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(1)"> {{workOrderDetail?.movement_sow}}</span>
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(5)">Local Job</span>
              </mat-menu>
            
              <button mat-button class="btn btn--primary ms-2 position-relative pe-4 btn--sm"  *ngIf="workOrderDetail?.movement_sow=='Deposit'" [matMenuTriggerFor]="menu2">Schedule <i
                class="material-icons schedule-arrow"> arrow_drop_down</i></button>
              <mat-menu #menu2="matMenu">
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(3)"> {{workOrderDetail?.movement_sow}}</span>
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(5)">Local Job</span>
              </mat-menu>

              <button mat-button class="btn btn--primary ms-2 position-relative pe-4 btn--sm"  *ngIf="workOrderDetail?.movement_sow=='Live Loading'" [matMenuTriggerFor]="menu3">Schedule <i
                class="material-icons schedule-arrow"> arrow_drop_down</i></button>
              <mat-menu #menu3="matMenu">
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(2)"> {{workOrderDetail?.movement_sow}}</span>
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(5)">Local Job</span>
              </mat-menu>

              <ng-container  *ngIf="workOrderDetail?.movement_sow=='Pullout & Deposit'">
                <button mat-button class="btn btn--primary ms-2 position-relative pe-4 btn--sm" [matMenuTriggerFor]="menu">Schedule <i
                  class="material-icons schedule-arrow"> arrow_drop_down</i></button>
                <mat-menu #menu="matMenu">
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(1)">Pullout</span>
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(3)">Deposit</span>
                <span mat-menu-item type="button" style="min-width: 120px;" class="def-color text-center" (click)="convertContainerToJob(5)">Local Job</span>
              </mat-menu>
              </ng-container>
            </ng-container>
            <ng-template #normalType>
              <button class="gb-btn gb-btn-basic ms-2 " (click)="convertContainerToJob(-1)">Schedule Job</button>
            </ng-template>
          </ng-container>
         <button class="gb-btn gb-btn-red ms-2" (click)="closeWorkOrder()" *ngIf="workOrderDetail?.closed_status != 'Closed'">Close</button>
      
      </ng-container>
      <button class="gb-edit-btn-secondary ms-2" (click)="editRequest()" >
        <span  class="material-icons"> create </span>Edit Request</button>
        <div matTooltip="Void restriction: Linked invoices must be deleted."
        [matTooltipDisabled]="!workOrderDetail?.invoice_exists" matTooltipClass="material-toltip-class">
      <button class="gb-btn gb-btn-red ms-2" (click)="openVoidQuotation()"  [disabled]="workOrderDetail?.invoice_exists"
        *ngIf="workOrderDetail.status.status_screen_to_show !='void' && workOrderDetail.status.status_screen_to_show !='approval_rejected'" >Void
        Sales Order</button>
      </div>

    </div>
  </div>
  <app-add-trip-v2-documents-expiry 
  [documentExpiryData]="documentExpiryData"></app-add-trip-v2-documents-expiry>
  
  <app-work-order-status-block [workOrderDetail]="workOrderDetail"></app-work-order-status-block>

  <div class="container-fluid  ">
    <div class=" row mx-0   px-4 py-3 details " [ngClass]="{'shadow-inset-bottom':workOrderDetail?.vehicle_category != 4}">
      <p class="col-lg-4 col-md-6 "><b>Sales Order Date: </b>{{changeDatetoNormalFormat(workOrderDetail?.workorder_date)}}
      </p>
      <p class="col-lg-4 col-md-6"><b>Customer: </b><a class="custom-link" target="_blank"
        [routerLink]="[prefixUrl+'/onboarding/party/details/client/',workOrderDetail?.customer?.id]">{{workOrderDetail?.customer?.display_name}}</a>
    </p>
      <ng-container *ngIf="workOrderDetail?.vehicle_category==0 || workOrderDetail?.vehicle_category==4">
        <p class="col-lg-4 col-md-6 "><b>Type Of Movement: </b>{{workOrderDetail?.type_of_movement }}</p>
      </ng-container>
      <ng-container *ngIf="workOrderDetail?.vehicle_category==4">
        <p class="col-lg-4 col-md-6 "><b>No. Of Containers: </b>{{noOfContainers}}</p>
      </ng-container>
      <ng-container  *ngIf="workOrderDetail?.vehicle_category==0">
        <p class="col-lg-4 col-md-6 "><b>Sales Order Start Date: </b>{{changeDatetoNormalFormat(workOrderDetail?.workstart_date)}}</p>
        <p class="col-lg-4 col-md-6 "><b>Expected Tenure: </b>{{workOrderDetail?.expected_tenure?.label ? workOrderDetail?.expected_tenure?.label : '-'}}</p>
        <p class="col-lg-4 col-md-6 "><b>Sales Order End Date: </b>{{changeDatetoNormalFormat(workOrderDetail?.workend_date)}}</p>
      </ng-container>

      <p class="col-lg-4 col-md-6 " ><b>Employee In Charge: </b><a *ngIf="workOrderDetail?.employee_in_charge?.id" class="custom-link" [routerLink]="[prefixUrl+'/onboarding/employee/view/',workOrderDetail?.employee_in_charge?.id]"  target="_blank"  >{{workOrderDetail?.employee_in_charge?.display_name}}</a>
        <span *ngIf="!workOrderDetail?.employee_in_charge?.id">-</span></p>
        <p class="col-lg-4 col-md-6 " ><b>Quotation No: </b><a *ngIf="workOrderDetail?.quotation?.id" class="custom-link" [routerLink]="[prefixUrl+'/trip/quotation/details/',workOrderDetail?.quotation?.id]"  target="_blank"  >{{workOrderDetail?.quotation?.quotation_no}}</a>
          <span *ngIf="!workOrderDetail?.quotation?.id">-</span></p>
        <p class="col-lg-4 col-md-6 "><b>Reference No: </b>{{workOrderDetail?.enquiry_no ? workOrderDetail?.enquiry_no : '-'}}
        </p>

        <ng-container *ngIf="workOrderDetail?.type_of_movement == 'Import' || workOrderDetail?.type_of_movement == 'Export'">
        <ng-container *ngIf="workOrderDetail?.vehicle_category==0">
          <p class="col-lg-4 col-md-6 "><b>{{workOrderDetail?.type_of_movement=='Import'? 'DO' : workOrderDetail?.type_of_movement=='Export' ? 'Booking' : ''}} No: </b>{{workOrderDetail?.no? workOrderDetail?.no : '-'}}</p>
          <p class="col-lg-4 col-md-6 "><b>{{workOrderDetail?.type_of_movement=='Import'? 'DO' : workOrderDetail?.type_of_movement=='Export' ? 'Booking':''}} Date: </b>{{workOrderDetail?.date? workOrderDetail?.date : '-'}}</p>
           <p class="col-lg-4 col-md-6 "><b>Is Inspection Required: </b>{{workOrderDetail?.is_inspection_required == 1 ?'Yes':'No'}}</p>
          <p class="col-lg-4 col-md-6 " *ngIf="workOrderDetail?.is_inspection_required == 1"><b >Type Of Inspection: </b> <span *ngFor="let inspection of workOrderDetail?.inspection_type;let last =last;">{{inspection?.label ? inspection?.label : '-'}}{{last ? '':', '}}</span> </p>
        </ng-container>

        <ng-container *ngIf="workOrderDetail?.vehicle_category==4">
          <p class="col-lg-4 col-md-6 "><b>{{workOrderDetail?.type_of_movement=='Import'? 'DO' : workOrderDetail?.type_of_movement=='Export' ? 'Booking' : ''}} No: </b>{{workOrderDetail?.no? workOrderDetail?.no : '-'}}</p>
          <p class="col-lg-4 col-md-6 "><b>{{workOrderDetail?.type_of_movement=='Import'? 'DO' : workOrderDetail?.type_of_movement=='Export' ? 'Booking':''}} Date: </b>{{workOrderDetail?.date? workOrderDetail?.date : '-'}}</p>
          <p class="col-lg-4 col-md-6 "><b>{{workOrderDetail?.type_of_movement=='Import'? 'DO Expiry' : workOrderDetail?.type_of_movement=='Export' ? 'Cut off' : ''}} Date: </b>{{workOrderDetail?.movement_expiry_cutoff_date? workOrderDetail?.movement_expiry_cutoff_date : '-'}}</p>
          <p class="col-lg-4 col-md-6 "><b>Scope of Work: </b>{{workOrderDetail?.movement_sow?workOrderDetail?.movement_sow:'-'}}</p>
        </ng-container>
      </ng-container>
      <p class="col-lg-4 col-md-6 "><b>Customer POC: </b>{{workOrderDetail?.poc ? workOrderDetail?.poc?.display_name:'-'}}</p>
    </div>

    <div class="d-flex py-4 px-5 row" *ngIf="workOrderDetail?.vehicle_category!=4">
      <div class="col-lg-4 ps-lg-5 mb-4  mb-lg-0  d-flex align-items-center">
        <div class="shadow-circle green-shadow me-4"><i class="bi bi-cash"></i></div>
        <div>
          <p class="fw-bolder fs-4 mb-2">{{workOrderDetail?.revenue}} {{ currency_type?.symbol}}</p>
          <small>
            <p class="fw-semibold">TOTAL REVENUE</p>
          </small>
        </div>
      </div>


      <div class="col-lg-4 ps-lg-5 mb-4  mb-lg-0 d-flex align-items-center position-relative">
        <div class="shadow-circle red-shadow me-4"><i class="bi bi-cash"></i></div>
        <div>
          <p class="fw-bolder fs-4 mb-2">{{workOrderDetail?.expense}} {{ currency_type?.symbol}}</p>
          <small>
            <p class="fw-semibold">TOTAL EXPENSE</p>
          </small>
        </div>
      </div>
      <div class="col-lg-4 ps-lg-5 mb-4  mb-lg-0 d-flex align-items-center">
        <div class="shadow-circle  me-4"
          [ngClass]=" {'green-shadow':workOrderDetail?.pl?.is_profit,'red-shadow':!workOrderDetail?.pl?.is_profit}"><i
            class="bi bi-cash"></i></div>
        <div>
          <p class="fw-bolder fs-4 mb-2">{{workOrderDetail?.pl.value}} {{ currency_type?.symbol}}</p>
          <small>
            <p class="fw-semibold">TOTAL P/L</p>
          </small>
        </div>
      </div>

    </div>
  </div>

</div>
<alert-popup [inputData]="popupInputDataClose" (outputData)="workorderClose($event)"></alert-popup>