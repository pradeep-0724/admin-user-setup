<div [ngClass]="{disabled: !showModal,'add-item':showManageDiscription,'mg-top-30':showManageDiscription}"  *ngIf="!inlineAdd && challanList.length>0">
  <ng-container  *ngIf="showManageDiscription">
    <span class="" [ngClass]="{'add-item__note': !challanErrorMessage, 'add-item__error': challanErrorMessage}"
    data-toggle="modal" data-target="#exampleModal" (click)="toggleChallanModal()">
    <i class="material-icons add-icon align-middle">add_circle_outline</i>
    <button class="align-middle mg-left-5 color-inherit" *ngIf="!challanErrorMessage"> Add Description</button>
    <span class="align-middle mg-left-5" *ngIf="challanErrorMessage">{{challanErrorMessage}}</span>
  </span>
  </ng-container>
 
</div>
<ng-container  *ngIf="showManageDiscription">
  <div class="align-manage-challan" *ngIf="inlineAdd && challanList.length>0">
    <button data-toggle="modal" class="p-0" data-target="#exampleModal" (click)="mapSelectedChallans();">
      <span class="material-icons add-icon align-add-icon align-middle">add_circle_outline</span>
      <span class="link-1"> Manage Descriptions</span>
    </button>
  </div>
</ng-container>


<form [formGroup]="challanListForm">
  <div class="modal fade modal-scrollable custom-centered-modal" [ngClass]="{show: showModal}" id="exampleModal" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal--wd-lg def-color" role="document">
      <div class="modal-content">
        <div class="modal-header row mx-0 p-0" style="padding: 10px 20px !important;" >
          <p  class="fs-6 def-color fw-semibold modal-title col-6" id="exampleModalLabel">Add Job</p>
          <div class="table-header__right col-md-4 col-6 justify-content-end px-0">
            <div id="demo-2">
              <input type="search" class="no-style search-bar input-search" placeholder="Search" (keyup)="searchitem()"
                [(ngModel)]="search" [ngModelOptions]="{standalone: true}">

            </div>
            <ng-container *ngIf="allData?.length">
              <button class="btn--action mg-left-10 hide_onClick py-1" [ngClass]="{'filterOpen':showFilter }" (click)="showFilter = !showFilter">
                <span  *ngIf="isFilterApplied && !showFilter" class="material-icons filterBullet">
                  fiber_manual_record
                  </span>
                  <img *ngIf="!isFilterApplied && !showFilter" src="assets/img/filter-icon.svg" alt="">
                  <img *ngIf="isFilterApplied && !showFilter" src="assets/img/filter_icon_2.svg" alt="">
                  <img *ngIf="showFilter" src="assets/img/filter-icon-svg-3.svg" alt="">
              </button>
              <app-filter [config]="options" [data]="allData" [visible]="showFilter" (onApplied)="filterApplied($event)"
                (onClear)="filterApplied($event)">
              </app-filter>
            </ng-container>
          </div>
        </div>
        
        <div class="modal-body pd-20">
          <!-- <div class="table-header p-0">
                      <div class="row">
                          <div class="col-md-6">
                              <div class="table-header__left"></div>
                          </div>
                          <div class="col-md-6">

                          </div>
                      </div>
                  </div> -->
          
            <div
              class="table-wrapper table-wrapper--type1 table-wrapper--type2 table--bd table--nobg table-wrapper--scroll">
              <table class="table-container">
                <thead>
                  <tr tabindex="-1">
                    <th width=5%>
                      <label for="check-trip-all" class="check-box" *ngIf="isAdd">
                        <input type="checkbox" id="check-trip-all" formControlName="selectedAll"
                          (change)="selectAllChalan()">
                        <span class="check-mark"></span>
                      </label>
                    </th>
                    <th width=15%>Sales Order No.</th>
                    <th width=10%>Job Date</th>
                    <th width=10%>Job No.</th>
                    <th width=10%>LPO No.</th>
                    <th *ngIf="paramsCategory==='container'" width=10%>Type of Movement</th>
                    <th *ngIf="paramsCategory==='container'" width=10%>Scope of Work</th>
                    <th *ngIf="paramsCategory==='container'" width=10%>Billing Type</th>
                    <th *ngIf="paramsCategory==='container'" width=10%>Container No</th>
                    <th width=15%>Vehicle No.</th>
                    <th width=15%>Start Location</th>
                    <th width=15%>End Location</th>
                  </tr>
                </thead>
                <tbody formArrayName="challans">
                  <tr *ngIf="challanList.length == 0">
                    <td colspan="10" style="background-color: #fff">
                      <div class="no-content-wrapper">
                        <figure class="no-content-pic">
                          <img src="assets/img/no-content.png" alt="">
                        </figure>
                        <div class="no-content-txt">
                          <h5 class="heading">No data found!</h5>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr *ngFor="let challan of challanList ; let i = index;" [formGroupName]="i">
                    <td class="table-checkbox">
                      <label for="check-trip-{{i}}" class="check-box">
                        <input type="checkbox" id="check-trip-{{i}}" formControlName="selectedChallan"
                          value="{{ challan.trip }}" (change)="onChallanSelected($event)">
                        <span class="check-mark"></span>
                      </label>
                    </td>
                    <td>
                      {{ challan.work_order_no ? challan.work_order_no : '-' }}
                    </td>
                    <td>
                      {{  challan.date}}
                    </td>
                    <td>
                      {{  challan.trip_id}}
                    </td>
                    <td>
                      {{  challan.lpo_no || '-'}}
                    </td>
                    <td  *ngIf="paramsCategory==='container'">
                      {{  challan?.type_of_movement}}
                    </td>
                    <td  *ngIf="paramsCategory==='container'">
                      {{  challan?.movement_sow}}
                    </td>
                    <td  *ngIf="paramsCategory==='container'">
                      {{  challan?.billing_type}}
                    </td>
                    <ng-container   *ngIf="paramsCategory==='container'">
                      <td>
                        <span  *ngFor="let num of challan?.containers_no;let last = last">{{  num}} <span>{{last? '':' ,'}}</span></span>

                      </td>
                    </ng-container>
                    <td>
                      {{ challan.vehicle ? challan.vehicle : '-' }}
                    </td>
                    <td>
                      {{ challan.from_loc ? challan.from_loc : '-' }}
                    </td>
                    <td>
                      {{ challan.to_loc ? challan.to_loc : '-' }}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          <ng-container  *ngIf="showDocument">
            <p class="fs-6 border-bottom py-3 my-3 def-color fw-semibold" *ngIf="challanListForm.controls.documents['controls'].length">Select Documents <app-tool-tip class="" [totalSlides]="1"
              position="right" [toolTipContent]="docToolTip"></app-tool-tip></p>
            <div formArrayName="documents" class="d-flex gap-3 flex-wrap">
              <div  *ngFor="let document of challanListForm.controls.documents['controls']; let i = index;" [formGroupName]="i" >
                <div class="table-checkbox d-flex align-items-center ">
                  <label for="check-trip-{{document.controls.document_name.value}}" class="check-box me-3">
                    <input type="checkbox" id="check-trip-{{document.controls.document_name.value}}" formControlName="selected" >
                    <span class="check-mark"></span>
                  </label>
                  <div>
                    {{document.controls.document_name.value}}
                  </div>
             
                </div>
              </div>
            </div>
          </ng-container>
        
        </div>
        <div class="d-flex justify-content-between align-items-center px-4 py-2 ">
          <button type="button" class="btn btn--sm" data-dismiss="modal" (click)=" close()">Close</button>
          <button type="button" class="btn btn--primary  btn--sm " (click)="selectChallans();popupOverflowHide()" *ngIf="!inlineAdd">Add</button>
          <button type="button" class="btn btn--primary btn--sm " (click)="manageChallan();popupOverflowHide()" *ngIf="inlineAdd">Update</button>
        </div>
      </div>
    </div>
  </div>
</form>
<div *ngIf="showModal" class="modal-backdrop fade show"></div>
