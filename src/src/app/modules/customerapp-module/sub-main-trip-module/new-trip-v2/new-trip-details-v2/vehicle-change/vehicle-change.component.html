<div class="edit-trip-popup">
  <div class="popup-header">
    <h6>Assign Vehicle</h6>
  </div>
  <app-add-trip-v2-documents-expiry [scheduledJobsForSelectedVehicleList]="scheduledJobsForSelectedVehicleList" [documentExpiryData]="documentExpiryData"></app-add-trip-v2-documents-expiry>


  <div class="popup-body">
    <form [formGroup]="changeVehicleForm">

      <div class="container-fluid">
        <div class="row"> 
          <div class="col-lg-6" *ngIf="vehicleCategory==1|| vehicleCategory==2">
            <div class="input-wrap error" [ngClass]="addErrorClass(changeVehicleForm.controls.specification)">
              <label for="" [ngClass]="{'input--required':vehicleCategory==1|| vehicleCategory==2}">SPECIFICATION</label>
              <material-dropdown [searchable]="true" [selectedOption]="initialDetails.specification">
                <select #customSelect formControlName="specification" class="no-style select--modify" (change)="getVehicleList()">
                  <option *ngFor="let option of vechileSpecifications" value="{{ option?.id }}">
                    {{ option?.specification }}
                </option>
                </select>
              </material-dropdown>
              <app-error [controlName]="changeVehicleForm.controls.specification"></app-error>
            </div>
          </div>
          <div class="input-wrap error input-box col-lg-4">
            <label for="" class="input--required">VEHICLE NO</label>
            <material-dropdown [searchable]="true"  [addItemText]="'+ Add Market Vehicle'"  [addable]="vehicleCategory !=10" [party]="true"
              [selectedOption]="initialDetails.vehicle"
              [isUpperCaseAllowed]="true"
              [addErrorClass]="addErrorClass(changeVehicleForm.controls.c_vehicle)"
              (addPartyPopup)="openAddVehicle($event)" (addValueToList)="addValueToVehiclePopUp($event)"
              [params]="vehicleNamePopup" [maxLength]="14">
              <select #customSelect formControlName="c_vehicle" class="no-style select--modify input--bd"
                (change)="onVehicleChange()">
                <option *ngFor="let option of vehicleList" value="{{ option?.id }}">
                  {{ option?.reg_number }}
                </option>
              </select>
            </material-dropdown>
            <div class="side-by-side">
              <p class="font-small-blue" *ngIf="vehicleType">&nbsp;{{vehicleType}}</p>
              <p class="font-small-blue" *ngIf="vehicleSpecFor3and4">&nbsp;{{vehicleSpecFor3and4}}</p>
            </div>
            <app-error [controlName]="changeVehicleForm.controls.c_vehicle"></app-error>
          </div>
          <ng-container  *ngIf="vehicleCategory ==0|| vehicleCategory ==4 || vehicleCategory ==10">
            <div class="col-lg-4 col-6"  [ngClass]="{'disable':isTransporterTrip}">
              <div class="input-wrap error dropdownArrow" [ngClass]="addErrorClass(changeVehicleForm.controls.asset_1)">
                <label for="" >ASSET NO.1 </label>
                <material-dropdown [searchable]="true" [addable]="false" [addBlank]="false"  [selectedOption]="initialDetails.assetOne"> 
                  <select #customSelect formControlName="asset_1" class="no-style select--modify"    (change)="assetOneSelected()">
                    <ng-container  *ngFor="let option of assetData">
                      <option  *ngIf="changeVehicleForm.get('asset_2').value !== option?.id && changeVehicleForm.get('asset_3').value !== option?.id" value="{{ option?.id }}">
                        {{ option?.display_no }}
                      </option>
                    </ng-container>
                  </select>
                </material-dropdown>
                <app-error [controlName]="changeVehicleForm.controls.asset_1"></app-error>
                <p class="font-small-blue" *ngIf="asset1Specification">&nbsp;{{asset1Specification}}</p>

              </div>
            </div>
            <div class="col-lg-4 col-6" [ngClass]="{'disable':isTransporterTrip}">
              <div class="input-wrap error dropdownArrow" [ngClass]="addErrorClass(changeVehicleForm.controls.asset_2)">
                <label for="" >ASSET NO.2 </label>
                <material-dropdown [searchable]="true" [addable]="false"  [addBlank]="false"  [selectedOption]="initialDetails.assetTwo">
                  <select #customSelect formControlName="asset_2" class="no-style select--modify"    (change)="assetTwoSelected()">
                    <ng-container  *ngFor="let option of assetData">
                      <option  *ngIf="changeVehicleForm.get('asset_1').value !== option?.id && changeVehicleForm.get('asset_3').value !== option?.id" value="{{ option?.id }}">
                        {{ option?.display_no }}
                      </option>
                    </ng-container>
                  </select>
                </material-dropdown>
                <app-error [controlName]="changeVehicleForm.controls.asset_2"></app-error>
                <p class="font-small-blue" *ngIf="asset2Specification">&nbsp;{{asset2Specification}}</p>
              </div>
            </div>
            <div class="col-lg-4 col-6" [ngClass]="{'disable':isTransporterTrip}">
              <div class="input-wrap error dropdownArrow" [ngClass]="addErrorClass(changeVehicleForm.controls.asset_3)">
                <label for="" >ASSET NO.3 </label>
                <material-dropdown [searchable]="true" [addable]="false"   [addBlank]="false" [selectedOption]="initialDetails.assetThree">
                  <select #customSelect formControlName="asset_3" class="no-style select--modify"    (change)="assetThreeSelected()">
                    <ng-container  *ngFor="let option of assetData">
                      <option  *ngIf="changeVehicleForm.get('asset_1').value !== option?.id && changeVehicleForm.get('asset_2').value !== option?.id" value="{{ option?.id }}">
                        {{ option?.display_no }}
                      </option>
                    </ng-container>
                  </select>
                </material-dropdown>
                <app-error [controlName]="changeVehicleForm.controls.asset_3"></app-error>
                <p class="font-small-blue" *ngIf="asset3Specification">&nbsp;{{asset3Specification}}</p>

              </div>
            </div>
          </ng-container>          

          <div *ngIf="!isTransporterTrip" class="col-lg-4 input-wrap error input-box">
            <label for="" class="driver-name">OPERATOR</label>
            <app-multi-driver-select   (selectedDriverList)="selectedDriverList($event)"  [driverList]="driverList" [driverControl]="changeVehicleForm.controls.driver"></app-multi-driver-select>
          </div>
          <div *ngIf="isTransporterTrip" class="input-wrap  input-box  col-lg-4">
            <label for="" class="input">OPERATOR</label>
            <input type="text" class="no-style input--bd" formControlName="driver">
          </div>

          <div *ngIf="isTransporterTrip" class="col-lg-4">
            <div class="input-wrap error">
              <label for="" class="input--required">VEHICLE PROVIDER</label>
              <material-dropdown [disabled]="true" [searchable]="true"
                [selectedOption]="initialDetails.vehicle_provider"
                [addable]="true" [addBlank]="true" [maxLength]="46" [status]="true" [party]="true"
                [addErrorClass]="addErrorClass(changeVehicleForm.controls.vehicle_provider)"
                (addPartyPopup)="openAddPartyModal($event, 'vendor')"
                (addValueToList)="addValueToPartyPopup($event, vehicleprovider)" [params]="partyNamePopup">
                <select #customSelect formControlName="vehicle_provider" class="no-style select--modify" (change)="onVehicleProviderChange()">
                  <option *ngFor="let option of partyListVendor" value="{{ option?.id }}">
                    {{ option?.party_display_name }}
                  </option>
                </select>
              </material-dropdown>

              <app-error [controlName]="changeVehicleForm.controls.vehicle_provider"></app-error>
            </div>
          </div>
          <div *ngIf="isTransporterTrip" class="col-lg-4">
            <div class="input-wrap error">
              <label for="" class="input">LPO</label>
              <material-dropdown [disabled]="true" [searchable]="true"
                [selectedOption]="initialDetails.lpo" [addBlank]="true"
                [addErrorClass]="addErrorClass(changeVehicleForm.controls.lpo)">
                <select #customSelect formControlName="lpo" class="no-style select--modify">
                  <option *ngFor="let option of lpoList" value="{{ option?.id }}">
                    {{ option?.name }}
                  </option>
                </select>
              </material-dropdown>

              <app-error [controlName]="changeVehicleForm.controls.lpo"></app-error>
            </div>
          </div>

          <div class="d-flex justify-content-space-between m-1 ">
            <button class="btn w-auto " (click)="cancelHeader()">Cancel</button>
            <button class="btn btn--primary w-auto" (click)="saveHeader()">Save</button>
          </div>
        </div>
      </div>
    </form>
  </div>


</div>

<app-add-party-popup *ngIf="showAddPartyPopup.status" vendorPartyType="2" [popDetail]="showAddPartyPopup"
  [isVendor]="vendor" (closeModal)="closePartyPopup()" (partyAdded)="addPartyToOption($event)"></app-add-party-popup>