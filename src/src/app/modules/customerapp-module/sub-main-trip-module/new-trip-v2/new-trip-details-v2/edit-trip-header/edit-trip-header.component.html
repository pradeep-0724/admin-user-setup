<div class="edit-trip-popup">
  <div class="popup-header ">
    <h6>Trip Detail</h6>
  </div>

  <app-add-trip-v2-documents-expiry  [documentExpiryData]="documentExpiryData"></app-add-trip-v2-documents-expiry>

  <div class="popup-body">
    <form [formGroup]="editTripHeaderForm">

      <div class="container-fluid">
        <div class="row">
          <div class="input-wrap input-box col-lg-4 error" [ngClass]="{'disabled':editDetails?.isTripStarted}">
            <label for="" class="input--required">VEHICLE NO</label>
            <material-dropdown [searchable]="true"   [addItemText]="'+ Add Market Vehicle'"  [isUpperCaseAllowed]="true" [addErrorClass]="addErrorClass(editTripHeaderForm.controls.vehicle)" [addable]="true" [party]="true"
              [selectedOption]="initialDetails.vehicle" [disabled]="editDetails?.isTripStarted"
              (addPartyPopup)="openAddVehicle($event)" (addValueToList)="addValueToVehiclePopUp($event)"
              [params]="vehicleNamePopup" [maxLength]="14">
              <select #customSelect formControlName="vehicle" class="no-style select--modify input--bd"
                (change)="onVehicleChange()">
                <option *ngFor="let option of vehicleList" value="{{ option?.id }}">
                  {{ option?.reg_number }}
                </option>
              </select>
            </material-dropdown>
            <p class="font-small-blue">&nbsp;{{vehicleType}}</p>
            <app-error [controlName]="editTripHeaderForm.controls.vehicle"></app-error>
          </div>

          <div  *ngIf="!isTransporterTrip"  class="col-lg-4 input-wrap input-box" [ngClass]="{'disabled':editDetails?.isTripStarted}">
            <label for="" class="driver-name">DRIVER NAME</label>
            <app-multi-driver-select [driverList]="driverList" [driverControl]="editTripHeaderForm.controls.driver" (driverId)="prefillDriverSelf($event)"></app-multi-driver-select>
          </div> 
          <div *ngIf="isTransporterTrip" class="input-wrap  input-box  col-lg-4" >
            <label for="" >DRIVER NAME</label>
            <input type="text" class="no-style input--bd" formControlName="driver">
          </div>


          <div class="input-wrap error dropdownArrow col-lg-4" [ngClass]="{'disabled':true}">
            <label for="" class="input--required">CUSTOMER </label>
            <material-dropdown [searchable]="true" [addable]="true" [selectedOption]="initialDetails.customer"
              [party]="true" [disabled]="true" [maxLength]="46" (addPartyPopup)="openAddPartyModal($event, 'client')"
              (addValueToList)="addValueToPartyPopup($event, billingParty)" [params]="partyNamePopup">
              <select #customSelect formControlName="customer" class="no-style select--modify">
              </select>
            </material-dropdown>
          </div>


          <div class="input-wrap error dropdownArrow col-lg-4" [ngClass]="{'disabled':true}">
            <label for="" class="input">WORK ORDER NO</label>
            <material-dropdown [searchable]="true" [disabled]="true" [selectedOption]="initialDetails.workorder">
              <select #customSelect formControlName="work_order_no" class="no-style select--modify">
              </select>
            </material-dropdown>
            <app-error [controlName]="editTripHeaderForm.controls.work_order_no"></app-error>
          </div>

          <div class="input-wrap error col-lg-4" [ngClass]="addErrorClass(editTripHeaderForm.controls.lr_no)">
            <label for="" class="input">REFERENCE NO.</label>
            <input type="text" formControlName="lr_no" class="input--bd" >
            <app-error [controlName]="editTripHeaderForm.controls.lr_no"></app-error>

          </div>
          <div *ngIf="isTransporterTrip" class="col-lg-4">
            <div class="input-wrap error" [ngClass]="{'disabled':editDetails?.isTripStarted}">
              <label for="" class="input--required">VEHICLE PROVIDER</label>
              <material-dropdown [disabled]="true" [searchable]="true"
                [selectedOption]="initialDetails.vehicle_provider" [disabled]="editDetails?.isTripStarted"
                [addable]="true" [addBlank]="true" [maxLength]="46" [status]="true" [party]="true"
                [addErrorClass]="addErrorClass(editTripHeaderForm.controls.vehicle_provider)"
                (addPartyPopup)="openAddPartyModal($event, 'vendor')"
                (addValueToList)="addValueToPartyPopup($event, vehicleprovider)" [params]="partyNamePopup">
                <select #customSelect formControlName="vehicle_provider" class="no-style select--modify">
                  <option *ngFor="let option of partyListVendor" value="{{ option?.id }}">
                    {{ option?.party_display_name }}
                  </option>
                </select>
              </material-dropdown>

              <app-error [controlName]="editTripHeaderForm.controls.vehicle_provider"></app-error>
            </div>
          </div>

          <div class="d-flex justify-content-space-between m-1 ">
            <button class="btn w-auto " (click)="cancelHeader()">Cancel</button>
            <button class="btn btn--primary w-auto" (click)="saveHeader()">Save</button>
          </div>
        </div>
      </div>
    </form>
  </div>


</div>

<app-add-party-popup *ngIf="showAddPartyPopup.status" vendorPartyType="2" [popDetail]="showAddPartyPopup" [isVendor]="vendor"
  (closeModal)="closePartyPopup()" (partyAdded)="addPartyToOption($event)"></app-add-party-popup>