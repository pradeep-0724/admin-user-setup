<div
  class="offcanvas offcanvas-end def-color"
  style="width: 450px; max-width: 100vw"
  [ngClass]="{ show: show }"
  data-bs-backdrop="static"
  tabindex="-1"
  id="staticBackdrop"
  aria-labelledby="staticBackdropLabel"
>
  <div class="p-3 px-4 fs-6 fw-semibold d-flex justify-content-between align-items-center approval-offcanvas-header">
    Approval Details
    <button
      type="button"
      class="close-btn gb-btn-hover"
      
      (click)="closePopup()"
      data-bs-dismiss="offcanvas"
      aria-label="Close"
    >
      <i class="bi bi-x-lg"></i>
    </button>
  </div>
  <div class=" approval-offcanvas-body p-4 " >
    <div class="no-list-data-wrap justify-content-start mt-5" *ngIf="timeline.length==0">
      <figure>
        <img src="assets/img/no-content.png" alt="">
      </figure>
      <h5 class="mt-3 primary-brand-text">No data found!</h5>
    </div>

    <div class="approver-stepper" *ngFor="let item of timeline; let i = index">
      <div class="step"*ngFor="let ele of item;let p=index;let o=last;" >
              <div class="stepper-line-wrap">
                <!-- 29th line for total background filled  and 30 for only color 36,37 also need to  look-->
                <div class="circle-name submitter" *ngIf="ele.actor == 0">{{findfingFirstName(ele.name)}}</div>
                <ng-container *ngIf="ele.actor != 0">
                  <div class="circle-name need_approval" *ngIf="ele.status === 'need_approval' && ele.actor == 2">{{findfingFirstName(ele.name)}}</div>
  
                  <div class="circle-name approved" *ngIf="(ele.actor==1 || ele.actor==2) && ele.status === 'approved'">{{findfingFirstName(ele.name)}}</div>
    
                  <div class="circle-name rejected" *ngIf="(ele.actor==1 || ele.actor==2 || ele.actor==4) && ele.status === 'rejected'">{{findfingFirstName(ele.name)}}</div>

                  <div class="circle-name edit-requested" *ngIf="ele.actor==3">{{findfingFirstName(ele.name)}}</div>

                </ng-container>
                
              </div>
              <div class="stepper-content">
                      <p class="email" *ngIf="ele.email">{{ele.email}}</p>
                      <p class="name">{{ ele.name }}</p>

                      <p class="status" *ngIf="ele.actor==0"> Submitter | {{ele.action_taken_at}}</p>
                      <ng-container *ngIf="ele.actor!=0" >
                        <p class="status "  *ngIf="ele.actor==2 && ele.status=='need_approval'"> <span class="sky-blue-text">Next Approval</span> </p>
                        <p class="status "  *ngIf="(ele.actor==1 || ele.actor==2) && ele.status=='approved'"><span class="green-text">Approved</span> | {{ele.action_taken_at}}</p>
                        <p class="status "  *ngIf="ele.actor==4"><span class="warn-text">Void</span> | {{ele.action_taken_at}}</p>
                        <p class="status "  *ngIf="ele.actor==3"><span class="gray-text">Edit Requested</span> | {{ele.action_taken_at}}</p>
                        <p class="status "  *ngIf="(ele.actor==1 || ele.actor==2) && ele.status =='rejected'"><span class="warn-text ">Rejected</span> | {{ele.action_taken_at}}</p>
                      </ng-container>
                      <ng-container *ngIf="ele.actor==3">

                        <div class="edit-req-wrap">
                          <p class="remark"  *ngIf="currI!=i || currP!=p">{{ ele.remark }}</p>
                          <form *ngIf="currI==i && currP==p">
                            <textarea  rows="3" class="edit-textarea-remark" [(ngModel)]="ele.remark">
                            </textarea> 
                          </form>
                          <div *ngIf="currI==i && currP==p" class="cancel-update-btn">
                            <button  (click)="cancelEdit(i,p)" class="def-color">Cancel</button>
                            <span class="mx-2">|</span>
                            <button  (click)="editRequest('update',ele.id,ele.remark)" class="green-text">Update</button>
                          </div>
                          <div class="edit-delete-btn" *ngIf="currI != i || currP !=p ">
                          <button (click)="currI=i;currP=p"  class="def-color gb-btn-hover mb-2"><span class="material-icons fs-6">
                            edit
                            </span></button>
                          <button (click)="editRequest('delete',ele.id,'')" class="error-text gb-btn-hover"><span class="material-icons fs-6">
                            delete
                            </span></button>
                          </div>
                        </div>
                        
                      </ng-container>
                      <ng-container *ngIf="ele.actor!=3">
                        <p class="remark" *ngIf="ele.remark">{{ ele.remark }}</p> 
                      </ng-container>
                      <p  class="seperator" *ngIf="o && i+1<timeline.length"></p>
                      
              </div>
      </div>
  
      
    
  </div>
   
        
  </div>
  
</div>


